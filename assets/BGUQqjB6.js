import{d as I,k as h,F as oe,y as r,G as f,H as l,z as o,I as w,A as t,J as P,K as C,L as E,B as b,_ as L,C as g,M as A,r as N,N as M,O as G,E as $,o as j,P as re,Q as Be,R as T,T as V,S as He,U as ze,D as Re,V as Xe,W as Fe,q as Y,e as Ye,X as Ve,g as ae}from"#entry";import{_ as Ue}from"./BgTe_uSv.js";const Ke={class:"flex space-x-1 mb-2"},qe={class:"card-content"},Je=I({__name:"PlayerCardDisplay",props:{currentPlayedCards:{},playerName:{},position:{}},setup(k){const s=k,p=h(()=>s.currentPlayedCards?s.currentPlayedCards.playerName===s.playerName:!1);oe(()=>{console.log(`PlayerCardDisplay - ${s.playerName}:`,{hasCurrentCards:!!s.currentPlayedCards,shouldShow:p.value,currentPlayerName:s.currentPlayedCards?.playerName||"none",cardCount:s.currentPlayedCards?.cards?.length||0,cards:s.currentPlayedCards?.cards?.map(i=>`${i.rank}${i.suit}`)||[],cardType:s.currentPlayedCards?.cardType})});const x=h(()=>{switch(s.position){case"left":return"left-full top-1/2 transform -translate-y-1/2 ml-2";case"right":return"right-full top-1/2 transform -translate-y-1/2 mr-2";case"bottom":return"bottom-full left-1/2 transform -translate-x-1/2 mb-2";default:return""}}),a=i=>{switch(i){case"hearts":case"diamonds":return"text-red-500";case"spades":case"clubs":return"text-black";case"joker":return"text-purple-600";default:return"text-black"}},m=i=>{switch(i){case"hearts":return"♥";case"diamonds":return"♦";case"clubs":return"♣";case"spades":return"♠";case"joker":return"★";default:return""}};return(i,c)=>l(p)?(o(),r("div",{key:0,class:w(["player-card-display absolute z-20",l(x)])},[t("div",Ke,[(o(!0),r(P,null,C(i.currentPlayedCards.cards,(d,e)=>(o(),r("div",{key:d.id,class:"playing-card-display",style:E({zIndex:e})},[t("div",qe,[t("div",{class:w(["card-rank",a(d.suit)])},b(d.rank),3),t("div",{class:w(["card-suit",a(d.suit)])},b(m(d.suit)),3)])],4))),128))])],2)):f("",!0)}}),le=L(Je,[["__scopeId","data-v-a4c6b926"]]),Oe={class:"relative"},Qe={class:"w-16 h-16 bg-gradient-to-br from-blue-400 to-purple-500 rounded-full flex items-center justify-center text-white font-bold text-lg shadow-lg"},We={key:0,class:"absolute -top-2 -right-2 w-8 h-8 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full flex items-center justify-center shadow-xl border-2 border-white"},Ze={key:1,class:"absolute -top-2 -right-2 w-8 h-8 bg-gradient-to-br from-green-400 to-green-600 rounded-full flex items-center justify-center shadow-xl border-2 border-white"},et={key:2,class:"absolute -bottom-2 -right-2 w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center shadow-lg"},tt={key:3,class:"absolute -inset-2 border-2 border-yellow-400 rounded-full animate-pulse"},st={class:"text-center"},nt={class:"text-white font-medium text-sm drop-shadow-lg"},at={key:0,class:"flex items-center justify-center space-x-1 mt-1"},ot={key:0,class:"text-xs text-blue-300"},rt={key:1,class:"text-xs text-yellow-300"},lt={key:2,class:"text-xs text-gray-300"},it={key:0,class:"flex items-center space-x-1"},dt={class:"text-white font-medium text-sm"},ct={key:1,class:"flex justify-center"},ut={key:0,class:"flex items-center justify-center w-6 h-8 text-white text-xs"},mt=I({__name:"PlayerArea",props:{player:{},isCurrentTurn:{type:Boolean},isLandlord:{type:Boolean},position:{},gamePhase:{},currentPlayedCards:{}},setup(k){const s=k,p=h(()=>{switch(s.position){case"top":return"transform -translate-x-1/2";case"left":return"";case"right":return"";case"bottom":return"transform -translate-x-1/2";default:return""}}),x=a=>a?a.charAt(0).toUpperCase():"?";return(a,m)=>{const i=A,c=le;return o(),r("div",{class:w(["flex flex-col items-center space-y-2 p-4 rounded-lg",a.isCurrentTurn?"bg-yellow-200 bg-opacity-20 border-2 border-yellow-400":"bg-black bg-opacity-10",l(p)])},[t("div",Oe,[t("div",Qe,b(x(a.player?.name||"")),1),a.isLandlord?(o(),r("div",We,[...m[0]||(m[0]=[t("span",{class:"text-white font-bold text-xs"},"地主",-1)])])):a.player&&a.gamePhase==="playing"?(o(),r("div",Ze,[...m[1]||(m[1]=[t("span",{class:"text-white font-bold text-xs"},"农民",-1)])])):f("",!0),a.player?.isAutoPlay?(o(),r("div",et,[g(i,{name:"robot",class:"w-3 h-3 text-white"})])):f("",!0),a.isCurrentTurn?(o(),r("div",tt)):f("",!0)]),t("div",st,[t("div",nt,b(a.player?.name||"空位"),1),a.player?(o(),r("div",at,[a.player.isAutoPlay?(o(),r("div",ot," 🤖 托管中 ")):a.isCurrentTurn?(o(),r("div",rt," ⏰ 思考中 ")):(o(),r("div",lt," ⏸️ 等待中 "))])):f("",!0)]),a.player?(o(),r("div",it,[g(i,{name:"cards",class:"w-4 h-4 text-white"}),t("span",dt,b(a.player.cards?.length||0)+"张 ",1)])):f("",!0),a.player&&a.player.cards?.length?(o(),r("div",ct,[t("div",{class:w(["flex",a.position==="top"?"-space-x-2":a.position==="left"||a.position==="right"?"flex-col -space-y-2":"-space-x-2"])},[(o(!0),r(P,null,C(Math.min(a.player.cards.length,10),d=>(o(),r("div",{key:d,class:w(["w-6 h-8 bg-gradient-to-br from-blue-800 to-blue-900 rounded border border-blue-600 shadow-sm",a.position==="left"||a.position==="right"?"w-8 h-6":""])},null,2))),128)),a.player.cards.length>10?(o(),r("div",ut," +"+b(a.player.cards.length-10),1)):f("",!0)],2)])):f("",!0),g(c,{"current-played-cards":a.currentPlayedCards,"player-name":a.player?.name||"",position:a.position},null,8,["current-played-cards","player-name","position"])],2)}}}),pt=L(mt,[["__scopeId","data-v-7662304a"]]),yt={class:"bg-black bg-opacity-30 rounded-2xl p-6 min-w-96 min-h-48 backdrop-blur-sm"},gt={class:"flex flex-col items-center space-y-4"},bt={key:0,class:"text-center"},ft={class:"text-yellow-300 font-medium ml-2"},ht={class:"flex justify-center items-center min-h-24"},vt={key:0,class:"flex space-x-2"},xt={key:1,class:"text-center text-gray-400"},wt={key:1,class:"mt-6 pt-4 border-t border-gray-600"},_t={class:"flex justify-center space-x-1"},$t={key:0,class:"flex space-x-1"},kt={key:1,class:"flex space-x-1"},Pt={class:"absolute bottom-4 right-4"},Ct={key:0,class:"absolute top-full left-0 right-0 mt-2 bg-black bg-opacity-80 rounded-lg p-4 max-h-48 overflow-y-auto"},It={class:"flex items-center justify-between mb-3"},St={class:"space-y-2"},Tt={class:"text-gray-300"},Lt={class:"text-white"},Nt={key:0,class:"text-center text-gray-500 py-4"},At=I({__name:"PlayArea",props:{lastPlayedCards:{},currentPlayerName:{},bottomCards:{},playHistory:{},gamePhase:{}},setup(k){const s=N(!1),p=a=>{switch(a){case"hearts":case"diamonds":return"text-red-500";case"spades":case"clubs":return"text-black";case"joker":return"text-purple-600";default:return"text-black"}},x=a=>{switch(a){case"hearts":return"♥";case"diamonds":return"♦";case"spades":return"♠";case"clubs":return"♣";case"joker":return"★";default:return""}};return(a,m)=>{const i=A;return o(),r("div",yt,[m[6]||(m[6]=t("div",{class:"text-center mb-4"},[t("h3",{class:"text-white text-lg font-semibold drop-shadow-lg"}," 出牌区域 ")],-1)),t("div",gt,[a.currentPlayerName?(o(),r("div",bt,[m[2]||(m[2]=t("span",{class:"text-gray-200 text-sm"},"当前出牌玩家:",-1)),t("span",ft,b(a.currentPlayerName),1)])):f("",!0),t("div",ht,[a.lastPlayedCards.length>0?(o(),r("div",vt,[(o(!0),r(P,null,C(a.lastPlayedCards,(c,d)=>(o(),r("div",{key:c.id,class:"playing-card bg-white rounded-lg shadow-lg flex flex-col items-center justify-center text-center p-2 transform hover:scale-105 transition-transform",style:E({zIndex:d})},[t("div",{class:w(["font-bold text-lg",p(c.suit)])},b(c.rank),3),t("div",{class:w(["text-sm",p(c.suit)])},b(x(c.suit)),3)],4))),128))])):(o(),r("div",xt,[g(i,{name:"cards",class:"w-12 h-12 mx-auto mb-2 opacity-50"}),m[3]||(m[3]=t("p",{class:"text-sm"},"等待出牌...",-1))]))]),a.bottomCards.length>0?(o(),r("div",wt,[m[4]||(m[4]=t("div",{class:"text-center mb-2"},[t("span",{class:"text-gray-200 text-sm"},"底牌:")],-1)),t("div",_t,[a.gamePhase==="bidding"?(o(),r("div",$t,[(o(),r(P,null,C(3,c=>t("div",{key:c,class:"w-8 h-12 bg-blue-600 rounded shadow flex items-center justify-center text-white text-xs border border-blue-400"},[g(i,{name:"cards",class:"w-3 h-3"})])),64))])):(o(),r("div",kt,[(o(!0),r(P,null,C(a.bottomCards,c=>(o(),r("div",{key:c.id,class:"w-8 h-12 bg-white rounded shadow flex flex-col items-center justify-center text-xs"},[t("div",{class:w(p(c.suit))},b(c.rank),3),t("div",{class:w(p(c.suit))},b(x(c.suit)),3)]))),128))]))])])):f("",!0)]),t("div",Pt,[t("button",{onClick:m[0]||(m[0]=c=>s.value=!l(s)),class:"p-2 bg-black bg-opacity-40 hover:bg-opacity-60 rounded-lg text-white transition-colors",title:"出牌历史"},[g(i,{name:"history",class:"w-4 h-4"})])]),l(s)?(o(),r("div",Ct,[t("div",It,[m[5]||(m[5]=t("h4",{class:"text-white font-medium"},"出牌历史",-1)),t("button",{onClick:m[1]||(m[1]=c=>s.value=!1),class:"text-gray-400 hover:text-white"},[g(i,{name:"x",class:"w-4 h-4"})])]),t("div",St,[(o(!0),r(P,null,C(a.playHistory.slice(-10),c=>(o(),r("div",{key:c.timestamp,class:"flex items-center justify-between text-sm"},[t("span",Tt,b(c.playerName)+":",1),t("span",Lt,b(c.cardType==="pass"?"过牌":`${c.cardType} (${c.cards.length}张)`),1)]))),128)),a.playHistory.length===0?(o(),r("div",Nt," 暂无出牌记录 ")):f("",!0)])])):f("",!0)])}}}),Mt=L(At,[["__scopeId","data-v-9116fbaa"]]),Dt={class:"bg-black bg-opacity-40 backdrop-blur-sm rounded-lg p-3 text-white min-w-32"},Et={class:"text-center"},jt={class:"mb-2"},Gt={class:"text-sm font-medium mb-1"},Bt={key:0,class:"text-xs text-gray-300"},Ht={key:0},zt={key:1,class:"text-xs text-gray-300"},Rt={key:0},Xt={class:"mt-1"},Ft={key:2,class:"text-xs text-gray-300"},Yt={key:0,class:"mt-1"},Vt=I({__name:"GamePhaseIndicator",props:{phase:{},biddingInfo:{},multiplierInfo:{}},setup(k){const s=k,p=M(),x=h(()=>{switch(s.phase){case"waiting":return"等待开始";case"bidding":return"叫地主";case"multiplier":return"决定倍数";case"playing":return"游戏中";case"ended":return"游戏结束";default:return"未知状态"}}),a=h(()=>{switch(s.phase){case"waiting":return"clock";case"bidding":return"hand-raised";case"multiplier":return"plus-circle";case"playing":return"play";case"ended":return"flag";default:return"info"}}),m=h(()=>{switch(s.phase){case"waiting":return"text-yellow-400";case"bidding":return"text-blue-400";case"multiplier":return"text-orange-400";case"playing":return"text-green-400";case"ended":return"text-red-400";default:return"text-gray-400"}}),i=()=>s.biddingInfo?.currentBidderId?p.players.find(e=>e.id===s.biddingInfo?.currentBidderId)?.name||"未知玩家":"",c=()=>s.multiplierInfo?.currentPlayerId?p.players.find(e=>e.id===s.multiplierInfo?.currentPlayerId)?.name||"未知玩家":"";return(d,e)=>{const n=A;return o(),r("div",Dt,[t("div",Et,[t("div",jt,[g(n,{name:l(a),class:w(["w-6 h-6 mx-auto",l(m)])},null,8,["name","class"])]),t("div",Gt,b(l(x)),1),d.phase==="bidding"&&d.biddingInfo?(o(),r("div",Bt,[d.biddingInfo.currentBidderId?(o(),r("div",Ht," 等待 "+b(i())+" 叫地主 ",1)):f("",!0)])):d.phase==="multiplier"&&d.multiplierInfo?(o(),r("div",zt,[d.multiplierInfo.currentPlayerId?(o(),r("div",Rt," 等待 "+b(c())+" 决定倍数 ",1)):f("",!0),t("div",Xt," 当前倍数: "+b(d.multiplierInfo.multiplier)+"倍 ",1)])):d.phase==="playing"?(o(),r("div",Ft,[e[0]||(e[0]=t("div",null,"游戏进行中",-1)),d.multiplierInfo?(o(),r("div",Yt," 最终倍数: "+b(d.multiplierInfo.multiplier)+"倍 ",1)):f("",!0)])):f("",!0)])])}}}),Ut={class:"p-4 space-y-4"},Kt={class:"relative flex justify-center mt-10zh"},qt={class:"flex justify-center items-end space-x-1 overflow-x-auto py-4 max-w-full"},Jt=["onClick"],Ot={class:"card-content"},Qt={key:0,class:"selected-indicator"},Wt={key:1,class:"suggested-indicator"},Zt={key:0,class:"text-center py-8 text-gray-500"},es={class:"text-center space-y-2"},ts={key:0,class:"flex justify-center"},ss={key:0,class:"inline-flex items-center px-3 py-1 bg-gradient-to-r from-yellow-400 to-orange-500 text-white rounded-full text-sm font-bold shadow-lg"},ns={key:1,class:"inline-flex items-center px-3 py-1 bg-gradient-to-r from-green-400 to-green-600 text-white rounded-full text-sm font-bold shadow-lg"},as={key:1,class:"inline-flex items-center px-4 py-2 bg-green-100 text-green-800 rounded-full text-sm font-medium animate-pulse"},os={key:0,class:"ml-2 text-xs bg-green-200 px-2 rounded"},rs={key:2,class:"inline-flex items-center px-4 py-2 bg-gray-100 text-gray-600 rounded-full text-sm"},ls=I({__name:"PlayerHandArea",props:{cards:{},selectedCards:{},canPlay:{type:Boolean},isMyTurn:{type:Boolean},suggestedCards:{},gamePhase:{},isLandlord:{type:Boolean},currentPlayedCards:{},playerName:{}},emits:["select-card"],setup(k){const s=k;oe(()=>{console.log(`PlayerHandArea - 玩家名称: "${s.playerName}"`)}),G(()=>s.isLandlord,a=>{console.log("=== PlayerHandArea 地主状态 ==="),console.log("isLandlord prop:",a),console.log("gamePhase:",s.gamePhase),console.log("===============================")},{immediate:!0});const p=a=>{switch(a){case"hearts":case"diamonds":return"text-red-500";case"spades":case"clubs":return"text-black";case"joker":return"text-purple-600";default:return"text-black"}},x=a=>{switch(a){case"hearts":return"♥";case"diamonds":return"♦";case"spades":return"♠";case"clubs":return"♣";case"joker":return"★";default:return""}};return(a,m)=>{const i=A,c=le;return o(),r("div",Ut,[t("div",Kt,[t("div",qt,[(o(!0),r(P,null,C(a.cards,(d,e)=>(o(),r("div",{key:d.id,onClick:n=>a.$emit("select-card",e),class:w(["playing-card cursor-pointer transition-all duration-200 flex-shrink-0",a.selectedCards.includes(e)?"selected":"",a.suggestedCards.includes(e)?"suggested":"",!a.canPlay&&!a.selectedCards.includes(e)?"disabled":""])},[t("div",Ot,[t("div",{class:w(["card-rank",p(d.suit)])},b(d.rank),3),t("div",{class:w(["card-suit",p(d.suit)])},b(x(d.suit)),3)]),a.selectedCards.includes(e)?(o(),r("div",Qt,[g(i,{name:"check",class:"w-3 h-3 text-white"})])):f("",!0),a.suggestedCards.includes(e)?(o(),r("div",Wt,[g(i,{name:"lightbulb",class:"w-3 h-3 text-yellow-400"})])):f("",!0)],10,Jt))),128))]),a.cards.length===0?(o(),r("div",Zt,[g(i,{name:"cards",class:"w-12 h-12 mx-auto mb-2 opacity-50"}),m[0]||(m[0]=t("p",null,"暂无手牌",-1))])):f("",!0)]),t("div",es,[a.gamePhase==="playing"?(o(),r("div",ts,[a.isLandlord?(o(),r("div",ss,[...m[1]||(m[1]=[t("span",{class:"mr-1"},"👑",-1),$(" 地主 ",-1)])])):(o(),r("div",ns,[...m[2]||(m[2]=[t("span",{class:"mr-1"},"🌾",-1),$(" 农民 ",-1)])]))])):f("",!0),a.isMyTurn?(o(),r("div",as,[g(i,{name:"clock",class:"w-4 h-4 mr-2"}),m[3]||(m[3]=$(" 轮到你出牌了 ",-1)),a.selectedCards.length>0?(o(),r("span",os," 已选 "+b(a.selectedCards.length)+" 张 ",1)):f("",!0)])):(o(),r("div",rs,[g(i,{name:"pause",class:"w-4 h-4 mr-2"}),m[4]||(m[4]=$(" 等待其他玩家 ",-1))]))]),g(c,{"current-played-cards":a.currentPlayedCards,"player-name":a.playerName,position:"bottom"},null,8,["current-played-cards","player-name"])])}}}),is=L(ls,[["__scopeId","data-v-0eef57b8"]]),ds={class:"space-y-2"},cs={key:0,class:"grid grid-cols-2 gap-1"},us={key:3,class:"grid grid-cols-2 gap-1"},ms={class:"grid grid-cols-3 gap-1"},ps=["title"],ys={key:0,class:"text-center"},gs={class:"flex items-center justify-center"},bs={class:"w-full bg-gray-600 rounded-full h-1 mt-2"},fs={key:1,class:"text-center"},hs={class:"inline-flex items-center px-2 py-1 bg-blue-500 bg-opacity-80 rounded text-white text-xs"},vs=I({__name:"GameControls",props:{gamePhase:{},isMyTurn:{type:Boolean},canPlay:{type:Boolean},canPass:{type:Boolean},autoPlayEnabled:{type:Boolean},timeLeft:{},canDouble:{type:Boolean},biddingInfo:{},multiplierInfo:{}},emits:["bid-landlord","play-cards","pass-turn","get-hint","toggle-auto-play","show-history","show-settings","pause-game","show-game-info","multiplier-decision"],setup(k){const s=N(),p=N({x:0,y:0}),x=N(!1),a=N({x:0,y:0,elementX:0,elementY:0});j(()=>{const e=localStorage.getItem("gameControlsPosition");if(e)try{const n=JSON.parse(e);p.value=n}catch(n){console.warn("Failed to parse saved position:",n)}});const m=()=>{localStorage.setItem("gameControlsPosition",JSON.stringify(p.value))},i=e=>{e.preventDefault(),x.value=!0;const n="touches"in e?e.touches[0].clientX:e.clientX,v="touches"in e?e.touches[0].clientY:e.clientY;a.value={x:n,y:v,elementX:p.value.x,elementY:p.value.y},document.addEventListener("mousemove",c),document.addEventListener("mouseup",d),document.addEventListener("touchmove",c),document.addEventListener("touchend",d)},c=e=>{if(!x.value)return;e.preventDefault();const n="touches"in e?e.touches[0].clientX:e.clientX,v="touches"in e?e.touches[0].clientY:e.clientY,y=n-a.value.x,B=v-a.value.y;p.value={x:a.value.elementX+y,y:a.value.elementY+B}},d=()=>{x.value&&(x.value=!1,document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",d),document.removeEventListener("touchmove",c),document.removeEventListener("touchend",d),m())};return re(()=>{document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",d),document.removeEventListener("touchmove",c),document.removeEventListener("touchend",d)}),(e,n)=>{const v=A;return o(),r("div",{ref_key:"controlPanel",ref:s,style:E({transform:`translate(${l(p).x}px, ${l(p).y}px)`}),class:"bg-black bg-opacity-40 backdrop-blur-sm rounded-lg p-3 space-y-3 select-none"},[t("div",{onMousedown:i,onTouchstart:i,class:"drag-handle flex items-center justify-center py-1 cursor-move border-b border-gray-600 mb-2 -mt-1"},[...n[14]||(n[14]=[Be('<div class="flex space-x-1" data-v-d09cfb02><div class="w-1 h-1 bg-gray-400 rounded-full" data-v-d09cfb02></div><div class="w-1 h-1 bg-gray-400 rounded-full" data-v-d09cfb02></div><div class="w-1 h-1 bg-gray-400 rounded-full" data-v-d09cfb02></div><div class="w-1 h-1 bg-gray-400 rounded-full" data-v-d09cfb02></div><div class="w-1 h-1 bg-gray-400 rounded-full" data-v-d09cfb02></div></div>',1)])],32),t("div",ds,[e.gamePhase==="bidding"&&e.isMyTurn?(o(),r("div",cs,[e.biddingInfo?.phase==="calling"?(o(),r(P,{key:0},[t("button",{onClick:n[0]||(n[0]=y=>e.$emit("bid-landlord","call")),class:"btn btn-warning btn-sm text-xs"}," 叫地主 "),t("button",{onClick:n[1]||(n[1]=y=>e.$emit("bid-landlord","pass")),class:"btn btn-secondary btn-sm text-xs"}," 不叫 ")],64)):f("",!0),e.biddingInfo?.phase==="grabbing"?(o(),r(P,{key:1},[t("button",{onClick:n[2]||(n[2]=y=>e.$emit("bid-landlord","grab")),class:"btn btn-danger btn-sm text-xs"}," 抢地主 "),t("button",{onClick:n[3]||(n[3]=y=>e.$emit("bid-landlord","pass")),class:"btn btn-secondary btn-sm text-xs"}," 不抢 ")],64)):f("",!0)])):f("",!0),e.gamePhase==="playing"&&e.isMyTurn&&e.canPlay?(o(),r("button",{key:1,onClick:n[4]||(n[4]=y=>e.$emit("play-cards")),class:"btn btn-success w-full text-sm"},[g(v,{name:"play",class:"w-4 h-4 mr-1"}),n[15]||(n[15]=$(" 出牌 ",-1))])):f("",!0),e.gamePhase==="playing"&&e.isMyTurn&&e.canPass?(o(),r("button",{key:2,onClick:n[5]||(n[5]=y=>e.$emit("pass-turn")),class:"btn btn-secondary w-full text-sm"},[g(v,{name:"x",class:"w-4 h-4 mr-1"}),n[16]||(n[16]=$(" 不要 ",-1))])):f("",!0),e.gamePhase==="multiplier"&&e.isMyTurn?(o(),r("div",us,[t("button",{onClick:n[6]||(n[6]=y=>e.$emit("multiplier-decision","double")),class:"btn btn-warning btn-sm text-xs"},[g(v,{name:"plus",class:"w-3 h-3 mr-1"}),n[17]||(n[17]=$(" 加倍 ",-1))]),t("button",{onClick:n[7]||(n[7]=y=>e.$emit("multiplier-decision","pass")),class:"btn btn-secondary btn-sm text-xs"},[g(v,{name:"x",class:"w-3 h-3 mr-1"}),n[18]||(n[18]=$(" 不加倍 ",-1))])])):f("",!0)]),t("div",ms,[t("button",{onClick:n[8]||(n[8]=y=>e.$emit("get-hint")),class:"btn btn-secondary btn-sm",title:"获取出牌提示"},[g(v,{name:"lightbulb",class:"w-3 h-3"})]),t("button",{onClick:n[9]||(n[9]=y=>e.$emit("toggle-auto-play")),class:w(["btn btn-sm",e.autoPlayEnabled?"btn-danger":"btn-secondary"]),title:e.autoPlayEnabled?"取消托管":"开启托管"},[g(v,{name:e.autoPlayEnabled?"robot":"user",class:"w-3 h-3"},null,8,["name"])],10,ps),t("button",{onClick:n[10]||(n[10]=y=>e.$emit("show-history")),class:"btn btn-secondary btn-sm",title:"查看出牌历史"},[g(v,{name:"history",class:"w-3 h-3"})]),t("button",{onClick:n[11]||(n[11]=y=>e.$emit("show-settings")),class:"btn btn-secondary btn-sm",title:"游戏设置"},[g(v,{name:"settings",class:"w-3 h-3"})]),t("button",{onClick:n[12]||(n[12]=y=>e.$emit("pause-game")),class:"btn btn-warning btn-sm",title:"暂停游戏"},[g(v,{name:"pause",class:"w-3 h-3"})]),t("button",{onClick:n[13]||(n[13]=y=>e.$emit("show-game-info")),class:"btn btn-info btn-sm",title:"游戏信息"},[g(v,{name:"info",class:"w-3 h-3"})])]),e.isMyTurn&&e.timeLeft>0?(o(),r("div",ys,[n[19]||(n[19]=t("div",{class:"text-white text-xs mb-1"},"剩余时间",-1)),t("div",gs,[t("div",{class:w(["text-lg font-bold",e.timeLeft<=10?"text-red-400 animate-pulse":"text-white"])},b(e.timeLeft)+"s ",3)]),t("div",bs,[t("div",{class:w(["h-1 rounded-full transition-all duration-1000",e.timeLeft<=10?"bg-red-500":"bg-blue-500"]),style:E({width:`${e.timeLeft/45*100}%`})},null,6)])])):f("",!0),e.autoPlayEnabled?(o(),r("div",fs,[t("div",hs,[g(v,{name:"robot",class:"w-3 h-3 mr-1 animate-spin"}),n[20]||(n[20]=$(" AI托管中 ",-1))])])):f("",!0)],4)}}}),xs=L(vs,[["__scopeId","data-v-d09cfb02"]]),ws={class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm"},_s={class:"bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full mx-4 text-center animate-scale-in"},$s={class:"mb-6"},ks={class:"text-gray-600"},Ps={class:"mb-6"},Cs={class:"space-y-3"},Is={class:"flex items-center space-x-3"},Ss={class:"w-8 h-8 bg-gradient-to-br from-blue-400 to-purple-500 rounded-full flex items-center justify-center text-white font-semibold text-sm"},Ts={class:"text-left"},Ls={class:"font-medium text-gray-900"},Ns={key:0,class:"text-xs text-blue-600 ml-1"},As={class:"text-xs text-gray-500"},Ms={class:"mb-6 p-4 bg-gray-50 rounded-lg"},Ds={class:"grid grid-cols-2 gap-4 text-sm"},Es={class:"text-center"},js={class:"text-gray-600"},Gs={class:"text-center"},Bs={class:"text-gray-600"},Hs={class:"space-y-3"},zs={class:"mt-4 pt-4 border-t border-gray-200"},Rs=I({__name:"GameResultModal",props:{result:{},players:{}},emits:["play-again","return-to-lobby"],setup(k,{emit:s}){const p=k,x=M(),a=h(()=>x.playerId),m=e=>e.charAt(0).toUpperCase(),i=e=>{const n=Math.floor(e/1e3),v=Math.floor(n/60),y=n%60;return v>0?`${v}分${y}秒`:`${y}秒`},c=e=>new Date(e).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}),d=async()=>{const e=`我在斗地主网游中${p.result.winnerId===a.value?"获胜了":"战败了"}！最终得分：${p.result.finalScores.find(n=>n.playerId===a.value)?.score||0}分`;if(navigator.share)try{await navigator.share({title:"斗地主游戏结果",text:e,url:window.location.origin})}catch{}else try{await navigator.clipboard.writeText(e),x.showNotification({type:"success",title:"复制成功",message:"游戏结果已复制到剪贴板"})}catch(n){console.error("复制失败:",n)}};return j(()=>{p.result.winnerId===a.value?console.log("播放胜利音效"):console.log("播放失败音效")}),(e,n)=>{const v=A;return o(),T(V,{to:"body"},[t("div",ws,[t("div",_s,[t("div",$s,[t("div",{class:w(["text-6xl mb-4",e.result.winnerId===l(a)?"animate-bounce":""])},b(e.result.winnerId===l(a)?"🎉":"😢"),3),t("h2",{class:w(["text-2xl font-bold mb-2",e.result.winnerId===l(a)?"text-green-600":"text-red-600"])},b(e.result.winnerId===l(a)?"恭喜获胜！":"游戏失败"),3),t("p",ks,b(e.result.isLandlordWin?"地主获胜":"农民获胜"),1)]),t("div",Ps,[n[2]||(n[2]=t("h3",{class:"text-lg font-semibold mb-4 text-gray-800"},"最终得分",-1)),t("div",Cs,[(o(!0),r(P,null,C(e.result.finalScores,y=>(o(),r("div",{key:y.playerId,class:w(["flex items-center justify-between p-3 rounded-lg",y.playerId===l(a)?"bg-blue-50 border-2 border-blue-200":"bg-gray-50"])},[t("div",Is,[t("div",Ss,b(m(y.playerName)),1),t("div",Ts,[t("div",Ls,[$(b(y.playerName)+" ",1),y.playerId===l(a)?(o(),r("span",Ns," (你) ")):f("",!0)]),t("div",As,b(y.isLandlord?"地主":"农民"),1)])]),t("div",{class:w(["font-bold text-lg",y.score>0?"text-green-600":y.score<0?"text-red-600":"text-gray-600"])},b(y.score>0?"+":"")+b(y.score),3)],2))),128))])]),t("div",Ms,[t("div",Ds,[t("div",Es,[n[3]||(n[3]=t("div",{class:"font-semibold text-gray-900"},"游戏时长",-1)),t("div",js,b(i(e.result.gameDuration)),1)]),t("div",Gs,[n[4]||(n[4]=t("div",{class:"font-semibold text-gray-900"},"结束时间",-1)),t("div",Bs,b(c(e.result.gameEndTime)),1)])])]),t("div",Hs,[t("button",{onClick:n[0]||(n[0]=y=>e.$emit("play-again")),class:"btn btn-primary btn-lg w-full"},[g(v,{name:"refresh",class:"w-5 h-5 mr-2"}),n[5]||(n[5]=$(" 再来一局 ",-1))]),t("button",{onClick:n[1]||(n[1]=y=>e.$emit("return-to-lobby")),class:"btn btn-secondary w-full"},[g(v,{name:"home",class:"w-5 h-5 mr-2"}),n[6]||(n[6]=$(" 返回大厅 ",-1))])]),t("div",zs,[t("button",{onClick:d,class:"text-sm text-gray-500 hover:text-gray-700 transition-colors"},[g(v,{name:"share",class:"w-4 h-4 mr-1"}),n[7]||(n[7]=$(" 分享游戏结果 ",-1))])])])])])}}}),Xs=L(Rs,[["__scopeId","data-v-39b28cb1"]]),Fs={class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm"},Ys={class:"bg-white rounded-2xl shadow-2xl p-8 max-w-sm w-full mx-4 text-center animate-fade-in"},Vs={class:"mb-6"},Us={class:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4"},Ks={class:"space-y-3"},qs={class:"mt-6 pt-6 border-t border-gray-200 text-sm text-gray-500"},Js={class:"grid grid-cols-2 gap-4"},Os={class:"text-center"},Qs={class:"text-center"},Ws=I({__name:"PauseMenu",emits:["resume","settings","exit"],setup(k,{emit:s}){const p=s,x=M(),a=h(()=>x.gameState?.turn||1),m=h(()=>{const d=x.gameState?.playHistory[0]?.timestamp||Date.now(),e=Date.now()-d,n=Math.floor(e/6e4),v=Math.floor(e%6e4/1e3);return`${n}:${v.toString().padStart(2,"0")}`}),i=async()=>{await x.showConfirmDialog({title:"确认退出",message:"确定要退出当前游戏吗？游戏进度将会丢失。",confirmText:"退出",cancelText:"取消"})&&p("exit")},c=d=>{d.code==="Escape"&&(d.preventDefault(),p("resume"))};return j(()=>{window.addEventListener("keydown",c)}),re(()=>{window.removeEventListener("keydown",c)}),(d,e)=>{const n=A;return o(),T(V,{to:"body"},[t("div",Fs,[t("div",Ys,[t("div",Vs,[t("div",Us,[g(n,{name:"pause",class:"w-8 h-8 text-gray-600"})]),e[2]||(e[2]=t("h2",{class:"text-2xl font-bold text-gray-800 mb-2"}," 游戏已暂停 ",-1)),e[3]||(e[3]=t("p",{class:"text-gray-600"}," 选择下一步操作 ",-1))]),t("div",Ks,[t("button",{onClick:e[0]||(e[0]=v=>d.$emit("resume")),class:"btn btn-primary btn-lg w-full"},[g(n,{name:"play",class:"w-5 h-5 mr-2"}),e[4]||(e[4]=$(" 继续游戏 ",-1))]),t("button",{onClick:e[1]||(e[1]=v=>d.$emit("settings")),class:"btn btn-secondary w-full"},[g(n,{name:"settings",class:"w-5 h-5 mr-2"}),e[5]||(e[5]=$(" 游戏设置 ",-1))]),t("button",{onClick:i,class:"btn btn-danger w-full"},[g(n,{name:"door-open",class:"w-5 h-5 mr-2"}),e[6]||(e[6]=$(" 退出游戏 ",-1))])]),t("div",qs,[t("div",Js,[t("div",Os,[e[7]||(e[7]=t("div",{class:"font-medium text-gray-700"},"当前回合",-1)),t("div",null,b(l(a)),1)]),t("div",Qs,[e[8]||(e[8]=t("div",{class:"font-medium text-gray-700"},"游戏时长",-1)),t("div",null,b(l(m)),1)])])]),e[9]||(e[9]=t("div",{class:"mt-4 text-xs text-gray-400"}," 按 ESC 键继续游戏 ",-1))])])])}}}),Zs=L(Ws,[["__scopeId","data-v-045c6c6a"]]),en={class:"flex-shrink-0"},tn={class:"flex flex-col"},sn={class:"font-bold text-lg"},nn={class:"text-sm opacity-90"},an={key:0,class:"flex space-x-1 ml-4"},on={key:0,class:"text-xs text-gray-300 flex items-center"},rn=I({__name:"ActionFeedback",setup(k){const{feedbacks:s}=He(),p=i=>{switch(i){case"bid":return"border-yellow-400 text-yellow-100";case"play":return"border-green-400 text-green-100";case"pass":return"border-gray-400 text-gray-100";case"landlord":return"border-red-400 text-red-100";case"auto-play":return"border-blue-400 text-blue-100";default:return"border-white text-white"}},x=i=>{switch(i){case"bid":return"megaphone";case"play":return"cards";case"pass":return"x-circle";case"landlord":return"star";case"auto-play":return"robot";default:return"info"}},a=i=>{const c=M();if(i.playerName===c.playerName)return{bottom:"140px",left:"32px",transform:"none"};{const n=c.players.findIndex(v=>v.name===i.playerName);if(n===1)return{top:"80px",left:"32px",transform:"none"};if(n===2)return{top:"80px",right:"32px",transform:"none"}}return{top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},m=i=>{switch(i){case"hearts":case"diamonds":return"text-red-500";case"spades":case"clubs":return"text-black";case"joker":return"text-purple-600";default:return"text-black"}};return(i,c)=>{const d=A;return o(),T(V,{to:"body"},[g(ze,{name:"action-feedback",tag:"div",class:"fixed inset-0 pointer-events-none z-[8000]"},{default:Re(()=>[(o(!0),r(P,null,C(l(s),e=>(o(),r("div",{key:e.id,class:w(["action-feedback-item absolute","bg-black bg-opacity-80 text-white px-4 py-2 rounded-xl shadow-2xl","flex items-center space-x-2 backdrop-blur-sm","border border-white border-opacity-20",p(e.type)]),style:E({...a(e),zIndex:8e3+e.id})},[t("div",en,[g(d,{name:x(e.type),class:"w-6 h-6"},null,8,["name"])]),t("div",tn,[t("div",sn,b(e.playerName),1),t("div",nn,b(e.message),1)]),e.cards&&e.cards.length>0?(o(),r("div",an,[(o(!0),r(P,null,C(e.cards.slice(0,5),n=>(o(),r("div",{key:n.id,class:w(["w-4 h-6 bg-white rounded text-xs flex items-center justify-center",m(n.suit)])},b(n.rank),3))),128)),e.cards.length>5?(o(),r("div",on," +"+b(e.cards.length-5),1)):f("",!0)])):f("",!0)],6))),128))]),_:1})])}}}),ln=L(rn,[["__scopeId","data-v-24d68c4e"]]),dn={class:"game-container"},cn={class:"game-table"},un={class:"player-area absolute left-8 top-16"},mn={class:"player-area absolute right-8 top-16"},pn={class:"absolute left-1/2 top-1/3 transform -translate-x-1/2 -translate-y-1/2 flex items-center justify-center"},yn={class:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-300 shadow-lg"},gn={class:"fixed bottom-5 right-12 z-50"},bn=I({__name:"game",setup(k){const s=M();Xe();const p=Fe(),x=N(!1),a=N(!1),m=N(null),i=h(()=>s.gamePhase),c=h(()=>s.currentPlayer),d=h(()=>s.gameState.currentPlayerId),e=h(()=>s.currentPlayer?.name||""),n=h(()=>s.landlord),v=h(()=>s.players),y=h(()=>s.opponents),B=h(()=>s.playerCards),ie=h(()=>s.selectedCards),de=h(()=>s.lastPlayedCards),ce=h(()=>s.bottomCards),U=h(()=>s.playHistory),H=h(()=>s.biddingInfo),z=h(()=>s.currentPlayedCards),K=h(()=>s.gameResult),ue=h(()=>s.isPaused),R=h(()=>s.isMyTurn),X=h(()=>s.canPlay),q=h(()=>s.canPass),me=h(()=>s.autoPlayEnabled),pe=h(()=>s.turnTimeLeft),ye=h(()=>s.suggestedCards),ge=h(()=>s.canPlayerDouble(s.playerId)),F=h(()=>s.multiplierInfo);h(()=>p.status);const be=h(()=>p.latency),fe=h(()=>p.quality),he=h(()=>p.connectionType);G([n,()=>s.playerId],([u,_])=>{console.log("=== 地主状态变化 ==="),console.log("地主对象:",u),console.log("地主ID:",u?.id),console.log("当前玩家ID:",_),console.log("是否是地主:",u?.id===_),console.log("===================")},{immediate:!0});const ve=u=>{s.selectCard(u)},J=async()=>{try{await s.playSelectedCards()}catch(u){console.error("出牌失败:",u),s.showNotification({type:"error",title:"出牌失败",message:"无法出牌，请检查选择的牌型"})}},O=async()=>{try{await s.passTurn()}catch(u){console.error("过牌失败:",u)}},Q=()=>{s.getPlayingHint()},W=()=>{s.toggleAutoPlay()},xe=async u=>{try{await s.handleBidLandlord(s.playerId,u)}catch(_){console.error("叫地主失败:",_)}},Z=()=>{console.log("暂停游戏按钮被点击"),s.pauseGame(),console.log("游戏已暂停，isPaused:",s.isPaused)},we=()=>{s.resumeGame()},ee=()=>{x.value=!0},_e=()=>{const u=M(),_={waiting:"等待中",bidding:"叫地主",multiplier:"决定倍数",playing:"游戏中",ended:"已结束"}[i.value]||"未知",S=c.value?c.value.name:"无",D=n.value?n.value.name:"未确定";u.showNotification({type:"info",title:"游戏信息",message:`阶段: ${_} | 当前: ${S} | 地主: ${D}`,duration:4e3})},$e=()=>{a.value=!0},ke=u=>{s.updateSettings(u),x.value=!1},Pe=async()=>{try{if(console.log("🔄 重新开始游戏"),s.players.some(_=>_.isAutoPlay)){console.log("🤖 AI模式 - 重新创建AI对局");const _=s.players.find(D=>D.isAutoPlay);let S="normal";_?.name.includes("新手")||_?.name.includes("学徒")?S="easy":(_?.name.includes("大师")||_?.name.includes("宗师"))&&(S="hard"),console.log("🎯 检测到AI难度:",S),await s.startAIGame(S)}else console.log("👥 多人模式 - 重置游戏状态"),await s.startNewGame();console.log("✅ 游戏重新开始成功")}catch(u){console.error("❌ 开始新游戏失败:",u)}},Ce=async()=>{await s.showConfirmDialog({title:"确认退出",message:"确定要退出游戏返回大厅吗？",confirmText:"退出",cancelText:"取消"})&&await te()},te=async()=>{try{await s.exitGame(),await Y("/")}catch(u){console.error("退出游戏失败:",u)}},Ie=u=>{s.handleMultiplierDecision(s.playerId,u)},se=u=>u?i.value==="bidding"?H.value.currentBidderId===u:i.value==="multiplier"?F.value.currentPlayerId===u:i.value==="playing"?d.value===u:!1:!1,ne=u=>{if(R.value)switch(u.code){case"Space":u.preventDefault(),X.value&&J();break;case"KeyP":u.preventDefault(),q.value&&O();break;case"KeyH":u.preventDefault(),Q();break;case"KeyA":u.preventDefault(),W();break;case"Escape":u.preventDefault(),Z();break}};return j(async()=>{try{if(!s.isGameActive){await Y("/");return}await s.initializeGameUI(),s.startGameLoop(),window.addEventListener("keydown",ne),p.startMonitoring(),console.log("游戏界面初始化完成")}catch(u){console.error("游戏初始化失败:",u),await Y("/")}}),Ye(()=>{window.removeEventListener("keydown",ne),s.stopGameLoop(),p.stopMonitoring()}),G(()=>s.gamePhase,u=>{u==="ended"&&setTimeout(()=>{s.showGameResult()},1e3)}),G(()=>p.status,u=>{u==="disconnected"?s.handleNetworkDisconnection():u==="connected"&&s.handleNetworkReconnection()}),j(()=>{document.addEventListener("visibilitychange",()=>{document.hidden?s.isGameActive&&!s.isPaused&&s.pauseGame():s.isPaused&&s.isGameActive&&s.showNotification({type:"info",title:"游戏已暂停",message:"点击恢复继续游戏",actions:[{label:"恢复游戏",action:()=>s.resumeGame()}]})})}),window.addEventListener("beforeunload",u=>{if(s.isGameActive)return u.preventDefault(),u.returnValue="游戏正在进行中，确定要离开吗？",u.returnValue}),Ve({title:"斗地主网游 - 游戏中",description:"正在进行斗地主游戏",robots:"noindex, nofollow"}),(u,_)=>{const S=pt,D=Mt,Se=Vt,Te=is,Le=xs,Ne=ae("NetworkIndicator"),Ae=Xs,Me=Zs,De=Ue,Ee=ae("PlayHistoryModal"),je=ln;return o(),r("div",dn,[t("div",cn,[t("div",un,[l(y)[0]?(o(),T(S,{key:0,player:l(y)[0],"is-current-turn":se(l(y)[0]?.id),"is-landlord":l(n)?.id===l(y)[0]?.id,"game-phase":l(i),"current-played-cards":l(z),position:"left"},null,8,["player","is-current-turn","is-landlord","game-phase","current-played-cards"])):f("",!0)]),t("div",mn,[l(y)[1]?(o(),T(S,{key:0,player:l(y)[1],"is-current-turn":se(l(y)[1]?.id),"is-landlord":l(n)?.id===l(y)[1]?.id,"game-phase":l(i),"current-played-cards":l(z),position:"right"},null,8,["player","is-current-turn","is-landlord","game-phase","current-played-cards"])):f("",!0)]),t("div",pn,[g(D,{"last-played-cards":l(de),"current-player-name":l(e),"bottom-cards":l(ce),"play-history":l(U),"game-phase":l(i)},null,8,["last-played-cards","current-player-name","bottom-cards","play-history","game-phase"])]),g(Se,{phase:l(i),"bidding-info":l(H),"multiplier-info":l(F),class:"absolute top-4 left-1/2 transform -translate-x-1/2"},null,8,["phase","bidding-info","multiplier-info"])]),t("div",yn,[g(Te,{cards:l(B),"selected-cards":l(ie),"can-play":l(X),"is-my-turn":l(R),"suggested-cards":l(ye),"game-phase":l(i),"is-landlord":l(n)?.id===l(s).playerId,"current-played-cards":l(z),"player-name":l(s).playerName,onSelectCard:ve},null,8,["cards","selected-cards","can-play","is-my-turn","suggested-cards","game-phase","is-landlord","current-played-cards","player-name"])]),t("div",gn,[g(Le,{"game-phase":l(i),"is-my-turn":l(R),"can-play":l(X),"can-pass":l(q),"auto-play-enabled":l(me),"time-left":l(pe),"can-double":l(ge),"bidding-info":l(H),"multiplier-info":l(F),onBidLandlord:xe,onPlayCards:J,onPassTurn:O,onGetHint:Q,onToggleAutoPlay:W,onShowHistory:$e,onShowSettings:ee,onPauseGame:Z,onShowGameInfo:_e,onMultiplierDecision:Ie},null,8,["game-phase","is-my-turn","can-play","can-pass","auto-play-enabled","time-left","can-double","bidding-info","multiplier-info"])]),g(Ne,{latency:l(be),quality:l(fe),"connection-type":l(he),class:"fixed top-4 left-4"},null,8,["latency","quality","connection-type"]),l(K)?(o(),T(Ae,{key:0,result:l(K),players:l(v),onPlayAgain:Pe,onReturnToLobby:Ce},null,8,["result","players"])):f("",!0),l(ue)?(o(),T(Me,{key:1,onResume:we,onSettings:ee,onExit:te})):f("",!0),l(x)?(o(),T(De,{key:2,onClose:_[0]||(_[0]=Ge=>x.value=!1),onSave:ke})):f("",!0),l(a)?(o(),T(Ee,{key:3,history:l(U),onClose:_[1]||(_[1]=Ge=>a.value=!1)},null,8,["history"])):f("",!0),g(je,{ref_key:"actionFeedbackRef",ref:m},null,512)])}}}),vn=L(bn,[["__scopeId","data-v-95b091fe"]]);export{vn as default};
