import{d as I,k as v,F as oe,y as r,G as g,H as l,z as o,I as w,A as t,J as P,K as C,L as M,B as y,_ as L,C as p,M as A,r as N,N as D,O as Y,E as $,o as j,P as re,Q as Ee,R as T,T as V,S as Me,U as je,D as Ge,q as X,e as Be,V as He,g as ae}from"#entry";import{_ as ze}from"./KU1cAscR.js";const Re={class:"flex space-x-1 mb-2"},Fe={class:"card-content"},Xe=I({__name:"PlayerCardDisplay",props:{currentPlayedCards:{},playerName:{},position:{}},setup(k){const s=k,b=v(()=>s.currentPlayedCards?s.currentPlayedCards.playerName===s.playerName:!1);oe(()=>{console.log(`PlayerCardDisplay - ${s.playerName}:`,{hasCurrentCards:!!s.currentPlayedCards,shouldShow:b.value,currentPlayerName:s.currentPlayedCards?.playerName||"none",cardCount:s.currentPlayedCards?.cards?.length||0,cards:s.currentPlayedCards?.cards?.map(m=>`${m.rank}${m.suit}`)||[],cardType:s.currentPlayedCards?.cardType})});const x=v(()=>{switch(s.position){case"left":return"left-full top-1/2 transform -translate-y-1/2 ml-2";case"right":return"right-full top-1/2 transform -translate-y-1/2 mr-2";case"bottom":return"bottom-full left-1/2 transform -translate-x-1/2 mb-2";default:return""}}),a=m=>{switch(m){case"hearts":case"diamonds":return"text-red-500";case"spades":case"clubs":return"text-black";case"joker":return"text-purple-600";default:return"text-black"}},i=m=>{switch(m){case"hearts":return"♥";case"diamonds":return"♦";case"clubs":return"♣";case"spades":return"♠";case"joker":return"★";default:return""}};return(m,u)=>l(b)?(o(),r("div",{key:0,class:w(["player-card-display absolute z-20",l(x)])},[t("div",Re,[(o(!0),r(P,null,C(m.currentPlayedCards.cards,(d,e)=>(o(),r("div",{key:d.id,class:"playing-card-display",style:M({zIndex:e})},[t("div",Fe,[t("div",{class:w(["card-rank",a(d.suit)])},y(d.rank),3),t("div",{class:w(["card-suit",a(d.suit)])},y(i(d.suit)),3)])],4))),128))])],2)):g("",!0)}}),le=L(Xe,[["__scopeId","data-v-a4c6b926"]]),Ye={class:"relative"},Ve={class:"w-16 h-16 bg-gradient-to-br from-blue-400 to-purple-500 rounded-full flex items-center justify-center text-white font-bold text-lg shadow-lg"},Ue={key:0,class:"absolute -top-2 -right-2 w-8 h-8 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full flex items-center justify-center shadow-xl border-2 border-white"},Ke={key:1,class:"absolute -top-2 -right-2 w-8 h-8 bg-gradient-to-br from-green-400 to-green-600 rounded-full flex items-center justify-center shadow-xl border-2 border-white"},qe={key:2,class:"absolute -bottom-2 -right-2 w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center shadow-lg"},Je={key:3,class:"absolute -inset-2 border-2 border-yellow-400 rounded-full animate-pulse"},Oe={class:"text-center"},Qe={class:"text-white font-medium text-sm drop-shadow-lg"},We={key:0,class:"flex items-center justify-center space-x-1 mt-1"},Ze={key:0,class:"text-xs text-blue-300"},et={key:1,class:"text-xs text-yellow-300"},tt={key:2,class:"text-xs text-gray-300"},st={key:0,class:"flex items-center space-x-1"},nt={class:"text-white font-medium text-sm"},at={key:1,class:"flex justify-center"},ot={key:0,class:"flex items-center justify-center w-6 h-8 text-white text-xs"},rt=I({__name:"PlayerArea",props:{player:{},isCurrentTurn:{type:Boolean},isLandlord:{type:Boolean},position:{},gamePhase:{},currentPlayedCards:{}},setup(k){const s=k,b=v(()=>{switch(s.position){case"top":return"transform -translate-x-1/2";case"left":return"";case"right":return"";case"bottom":return"transform -translate-x-1/2";default:return""}}),x=a=>a?a.charAt(0).toUpperCase():"?";return(a,i)=>{const m=A,u=le;return o(),r("div",{class:w(["flex flex-col items-center space-y-2 p-4 rounded-lg",a.isCurrentTurn?"bg-yellow-200 bg-opacity-20 border-2 border-yellow-400":"bg-black bg-opacity-10",l(b)])},[t("div",Ye,[t("div",Ve,y(x(a.player?.name||"")),1),a.isLandlord?(o(),r("div",Ue,[...i[0]||(i[0]=[t("span",{class:"text-white font-bold text-xs"},"地主",-1)])])):a.player&&a.gamePhase==="playing"?(o(),r("div",Ke,[...i[1]||(i[1]=[t("span",{class:"text-white font-bold text-xs"},"农民",-1)])])):g("",!0),a.player?.isAutoPlay?(o(),r("div",qe,[p(m,{name:"robot",class:"w-3 h-3 text-white"})])):g("",!0),a.isCurrentTurn?(o(),r("div",Je)):g("",!0)]),t("div",Oe,[t("div",Qe,y(a.player?.name||"空位"),1),a.player?(o(),r("div",We,[a.player.isAutoPlay?(o(),r("div",Ze," 🤖 托管中 ")):a.isCurrentTurn?(o(),r("div",et," ⏰ 思考中 ")):(o(),r("div",tt," ⏸️ 等待中 "))])):g("",!0)]),a.player?(o(),r("div",st,[p(m,{name:"cards",class:"w-4 h-4 text-white"}),t("span",nt,y(a.player.cards?.length||0)+"张 ",1)])):g("",!0),a.player&&a.player.cards?.length?(o(),r("div",at,[t("div",{class:w(["flex",a.position==="top"?"-space-x-2":a.position==="left"||a.position==="right"?"flex-col -space-y-2":"-space-x-2"])},[(o(!0),r(P,null,C(Math.min(a.player.cards.length,10),d=>(o(),r("div",{key:d,class:w(["w-6 h-8 bg-gradient-to-br from-blue-800 to-blue-900 rounded border border-blue-600 shadow-sm",a.position==="left"||a.position==="right"?"w-8 h-6":""])},null,2))),128)),a.player.cards.length>10?(o(),r("div",ot," +"+y(a.player.cards.length-10),1)):g("",!0)],2)])):g("",!0),p(u,{"current-played-cards":a.currentPlayedCards,"player-name":a.player?.name||"",position:a.position},null,8,["current-played-cards","player-name","position"])],2)}}}),lt=L(rt,[["__scopeId","data-v-7662304a"]]),it={class:"bg-black bg-opacity-30 rounded-2xl p-6 min-w-96 min-h-48 backdrop-blur-sm"},dt={class:"flex flex-col items-center space-y-4"},ct={key:0,class:"text-center"},ut={class:"text-yellow-300 font-medium ml-2"},mt={class:"flex justify-center items-center min-h-24"},pt={key:0,class:"flex space-x-2"},yt={key:1,class:"text-center text-gray-400"},gt={key:1,class:"mt-6 pt-4 border-t border-gray-600"},bt={class:"flex justify-center space-x-1"},ft={key:0,class:"flex space-x-1"},ht={key:1,class:"flex space-x-1"},vt={class:"absolute bottom-4 right-4"},xt={key:0,class:"absolute top-full left-0 right-0 mt-2 bg-black bg-opacity-80 rounded-lg p-4 max-h-48 overflow-y-auto"},wt={class:"flex items-center justify-between mb-3"},_t={class:"space-y-2"},$t={class:"text-gray-300"},kt={class:"text-white"},Pt={key:0,class:"text-center text-gray-500 py-4"},Ct=I({__name:"PlayArea",props:{lastPlayedCards:{},currentPlayerName:{},bottomCards:{},playHistory:{},gamePhase:{}},setup(k){const s=N(!1),b=a=>{switch(a){case"hearts":case"diamonds":return"text-red-500";case"spades":case"clubs":return"text-black";case"joker":return"text-purple-600";default:return"text-black"}},x=a=>{switch(a){case"hearts":return"♥";case"diamonds":return"♦";case"spades":return"♠";case"clubs":return"♣";case"joker":return"★";default:return""}};return(a,i)=>{const m=A;return o(),r("div",it,[i[6]||(i[6]=t("div",{class:"text-center mb-4"},[t("h3",{class:"text-white text-lg font-semibold drop-shadow-lg"}," 出牌区域 ")],-1)),t("div",dt,[a.currentPlayerName?(o(),r("div",ct,[i[2]||(i[2]=t("span",{class:"text-gray-200 text-sm"},"当前出牌玩家:",-1)),t("span",ut,y(a.currentPlayerName),1)])):g("",!0),t("div",mt,[a.lastPlayedCards.length>0?(o(),r("div",pt,[(o(!0),r(P,null,C(a.lastPlayedCards,(u,d)=>(o(),r("div",{key:u.id,class:"playing-card bg-white rounded-lg shadow-lg flex flex-col items-center justify-center text-center p-2 transform hover:scale-105 transition-transform",style:M({zIndex:d})},[t("div",{class:w(["font-bold text-lg",b(u.suit)])},y(u.rank),3),t("div",{class:w(["text-sm",b(u.suit)])},y(x(u.suit)),3)],4))),128))])):(o(),r("div",yt,[p(m,{name:"cards",class:"w-12 h-12 mx-auto mb-2 opacity-50"}),i[3]||(i[3]=t("p",{class:"text-sm"},"等待出牌...",-1))]))]),a.bottomCards.length>0?(o(),r("div",gt,[i[4]||(i[4]=t("div",{class:"text-center mb-2"},[t("span",{class:"text-gray-200 text-sm"},"底牌:")],-1)),t("div",bt,[a.gamePhase==="bidding"?(o(),r("div",ft,[(o(),r(P,null,C(3,u=>t("div",{key:u,class:"w-8 h-12 bg-blue-600 rounded shadow flex items-center justify-center text-white text-xs border border-blue-400"},[p(m,{name:"cards",class:"w-3 h-3"})])),64))])):(o(),r("div",ht,[(o(!0),r(P,null,C(a.bottomCards,u=>(o(),r("div",{key:u.id,class:"w-8 h-12 bg-white rounded shadow flex flex-col items-center justify-center text-xs"},[t("div",{class:w(b(u.suit))},y(u.rank),3),t("div",{class:w(b(u.suit))},y(x(u.suit)),3)]))),128))]))])])):g("",!0)]),t("div",vt,[t("button",{onClick:i[0]||(i[0]=u=>s.value=!l(s)),class:"p-2 bg-black bg-opacity-40 hover:bg-opacity-60 rounded-lg text-white transition-colors",title:"出牌历史"},[p(m,{name:"history",class:"w-4 h-4"})])]),l(s)?(o(),r("div",xt,[t("div",wt,[i[5]||(i[5]=t("h4",{class:"text-white font-medium"},"出牌历史",-1)),t("button",{onClick:i[1]||(i[1]=u=>s.value=!1),class:"text-gray-400 hover:text-white"},[p(m,{name:"x",class:"w-4 h-4"})])]),t("div",_t,[(o(!0),r(P,null,C(a.playHistory.slice(-10),u=>(o(),r("div",{key:u.timestamp,class:"flex items-center justify-between text-sm"},[t("span",$t,y(u.playerName)+":",1),t("span",kt,y(u.cardType==="pass"?"过牌":`${u.cardType} (${u.cards.length}张)`),1)]))),128)),a.playHistory.length===0?(o(),r("div",Pt," 暂无出牌记录 ")):g("",!0)])])):g("",!0)])}}}),It=L(Ct,[["__scopeId","data-v-9116fbaa"]]),St={class:"bg-black bg-opacity-40 backdrop-blur-sm rounded-lg p-3 text-white min-w-32"},Tt={class:"text-center"},Lt={class:"mb-2"},Nt={class:"text-sm font-medium mb-1"},At={key:0,class:"text-xs text-gray-300"},Dt={key:0},Et={key:1,class:"text-xs text-gray-300"},Mt={key:0},jt={class:"mt-1"},Gt={key:2,class:"text-xs text-gray-300"},Bt={key:0,class:"mt-1"},Ht=I({__name:"GamePhaseIndicator",props:{phase:{},biddingInfo:{},multiplierInfo:{}},setup(k){const s=k,b=D(),x=v(()=>{switch(s.phase){case"waiting":return"等待开始";case"bidding":return"叫地主";case"multiplier":return"决定倍数";case"playing":return"游戏中";case"ended":return"游戏结束";default:return"未知状态"}}),a=v(()=>{switch(s.phase){case"waiting":return"clock";case"bidding":return"hand-raised";case"multiplier":return"plus-circle";case"playing":return"play";case"ended":return"flag";default:return"info"}}),i=v(()=>{switch(s.phase){case"waiting":return"text-yellow-400";case"bidding":return"text-blue-400";case"multiplier":return"text-orange-400";case"playing":return"text-green-400";case"ended":return"text-red-400";default:return"text-gray-400"}}),m=()=>s.biddingInfo?.currentBidderId?b.players.find(e=>e.id===s.biddingInfo?.currentBidderId)?.name||"未知玩家":"",u=()=>s.multiplierInfo?.currentPlayerId?b.players.find(e=>e.id===s.multiplierInfo?.currentPlayerId)?.name||"未知玩家":"";return(d,e)=>{const n=A;return o(),r("div",St,[t("div",Tt,[t("div",Lt,[p(n,{name:l(a),class:w(["w-6 h-6 mx-auto",l(i)])},null,8,["name","class"])]),t("div",Nt,y(l(x)),1),d.phase==="bidding"&&d.biddingInfo?(o(),r("div",At,[d.biddingInfo.currentBidderId?(o(),r("div",Dt," 等待 "+y(m())+" 叫地主 ",1)):g("",!0)])):d.phase==="multiplier"&&d.multiplierInfo?(o(),r("div",Et,[d.multiplierInfo.currentPlayerId?(o(),r("div",Mt," 等待 "+y(u())+" 决定倍数 ",1)):g("",!0),t("div",jt," 当前倍数: "+y(d.multiplierInfo.multiplier)+"倍 ",1)])):d.phase==="playing"?(o(),r("div",Gt,[e[0]||(e[0]=t("div",null,"游戏进行中",-1)),d.multiplierInfo?(o(),r("div",Bt," 最终倍数: "+y(d.multiplierInfo.multiplier)+"倍 ",1)):g("",!0)])):g("",!0)])])}}}),zt={class:"p-4 space-y-4"},Rt={class:"relative flex justify-center mt-10zh"},Ft={class:"flex justify-center items-end space-x-1 overflow-x-auto py-4 max-w-full"},Xt=["onClick"],Yt={class:"card-content"},Vt={key:0,class:"selected-indicator"},Ut={key:1,class:"suggested-indicator"},Kt={key:0,class:"text-center py-8 text-gray-500"},qt={class:"text-center space-y-2"},Jt={key:0,class:"flex justify-center"},Ot={key:0,class:"inline-flex items-center px-3 py-1 bg-gradient-to-r from-yellow-400 to-orange-500 text-white rounded-full text-sm font-bold shadow-lg"},Qt={key:1,class:"inline-flex items-center px-3 py-1 bg-gradient-to-r from-green-400 to-green-600 text-white rounded-full text-sm font-bold shadow-lg"},Wt={key:1,class:"inline-flex items-center px-4 py-2 bg-green-100 text-green-800 rounded-full text-sm font-medium animate-pulse"},Zt={key:0,class:"ml-2 text-xs bg-green-200 px-2 rounded"},es={key:2,class:"inline-flex items-center px-4 py-2 bg-gray-100 text-gray-600 rounded-full text-sm"},ts=I({__name:"PlayerHandArea",props:{cards:{},selectedCards:{},canPlay:{type:Boolean},isMyTurn:{type:Boolean},suggestedCards:{},gamePhase:{},isLandlord:{type:Boolean},currentPlayedCards:{},playerName:{}},emits:["select-card"],setup(k){const s=k;oe(()=>{console.log(`PlayerHandArea - 玩家名称: "${s.playerName}"`)}),Y(()=>s.isLandlord,a=>{console.log("=== PlayerHandArea 地主状态 ==="),console.log("isLandlord prop:",a),console.log("gamePhase:",s.gamePhase),console.log("===============================")},{immediate:!0});const b=a=>{switch(a){case"hearts":case"diamonds":return"text-red-500";case"spades":case"clubs":return"text-black";case"joker":return"text-purple-600";default:return"text-black"}},x=a=>{switch(a){case"hearts":return"♥";case"diamonds":return"♦";case"spades":return"♠";case"clubs":return"♣";case"joker":return"★";default:return""}};return(a,i)=>{const m=A,u=le;return o(),r("div",zt,[t("div",Rt,[t("div",Ft,[(o(!0),r(P,null,C(a.cards,(d,e)=>(o(),r("div",{key:d.id,onClick:n=>a.$emit("select-card",e),class:w(["playing-card cursor-pointer transition-all duration-200 flex-shrink-0",a.selectedCards.includes(e)?"selected":"",a.suggestedCards.includes(e)?"suggested":"",!a.canPlay&&!a.selectedCards.includes(e)?"disabled":""])},[t("div",Yt,[t("div",{class:w(["card-rank",b(d.suit)])},y(d.rank),3),t("div",{class:w(["card-suit",b(d.suit)])},y(x(d.suit)),3)]),a.selectedCards.includes(e)?(o(),r("div",Vt,[p(m,{name:"check",class:"w-3 h-3 text-white"})])):g("",!0),a.suggestedCards.includes(e)?(o(),r("div",Ut,[p(m,{name:"lightbulb",class:"w-3 h-3 text-yellow-400"})])):g("",!0)],10,Xt))),128))]),a.cards.length===0?(o(),r("div",Kt,[p(m,{name:"cards",class:"w-12 h-12 mx-auto mb-2 opacity-50"}),i[0]||(i[0]=t("p",null,"暂无手牌",-1))])):g("",!0)]),t("div",qt,[a.gamePhase==="playing"?(o(),r("div",Jt,[a.isLandlord?(o(),r("div",Ot,[...i[1]||(i[1]=[t("span",{class:"mr-1"},"👑",-1),$(" 地主 ",-1)])])):(o(),r("div",Qt,[...i[2]||(i[2]=[t("span",{class:"mr-1"},"🌾",-1),$(" 农民 ",-1)])]))])):g("",!0),a.isMyTurn?(o(),r("div",Wt,[p(m,{name:"clock",class:"w-4 h-4 mr-2"}),i[3]||(i[3]=$(" 轮到你出牌了 ",-1)),a.selectedCards.length>0?(o(),r("span",Zt," 已选 "+y(a.selectedCards.length)+" 张 ",1)):g("",!0)])):(o(),r("div",es,[p(m,{name:"pause",class:"w-4 h-4 mr-2"}),i[4]||(i[4]=$(" 等待其他玩家 ",-1))]))]),p(u,{"current-played-cards":a.currentPlayedCards,"player-name":a.playerName,position:"bottom"},null,8,["current-played-cards","player-name"])])}}}),ss=L(ts,[["__scopeId","data-v-0eef57b8"]]),ns={class:"space-y-2"},as={key:0,class:"grid grid-cols-2 gap-1"},os={key:3,class:"grid grid-cols-2 gap-1"},rs={class:"grid grid-cols-3 gap-1"},ls=["title"],is={key:0,class:"text-center"},ds={class:"flex items-center justify-center"},cs={class:"w-full bg-gray-600 rounded-full h-1 mt-2"},us={key:1,class:"text-center"},ms={class:"inline-flex items-center px-2 py-1 bg-blue-500 bg-opacity-80 rounded text-white text-xs"},ps=I({__name:"GameControls",props:{gamePhase:{},isMyTurn:{type:Boolean},canPlay:{type:Boolean},canPass:{type:Boolean},autoPlayEnabled:{type:Boolean},timeLeft:{},canDouble:{type:Boolean},biddingInfo:{},multiplierInfo:{}},emits:["bid-landlord","play-cards","pass-turn","get-hint","toggle-auto-play","show-history","show-settings","pause-game","show-game-info","multiplier-decision"],setup(k){const s=N(),b=N({x:0,y:0}),x=N(!1),a=N({x:0,y:0,elementX:0,elementY:0});j(()=>{const e=localStorage.getItem("gameControlsPosition");if(e)try{const n=JSON.parse(e);b.value=n}catch(n){console.warn("Failed to parse saved position:",n)}});const i=()=>{localStorage.setItem("gameControlsPosition",JSON.stringify(b.value))},m=e=>{e.preventDefault(),x.value=!0;const n="touches"in e?e.touches[0].clientX:e.clientX,f="touches"in e?e.touches[0].clientY:e.clientY;a.value={x:n,y:f,elementX:b.value.x,elementY:b.value.y},document.addEventListener("mousemove",u),document.addEventListener("mouseup",d),document.addEventListener("touchmove",u),document.addEventListener("touchend",d)},u=e=>{if(!x.value)return;e.preventDefault();const n="touches"in e?e.touches[0].clientX:e.clientX,f="touches"in e?e.touches[0].clientY:e.clientY,h=n-a.value.x,G=f-a.value.y;b.value={x:a.value.elementX+h,y:a.value.elementY+G}},d=()=>{x.value&&(x.value=!1,document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",d),document.removeEventListener("touchmove",u),document.removeEventListener("touchend",d),i())};return re(()=>{document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",d),document.removeEventListener("touchmove",u),document.removeEventListener("touchend",d)}),(e,n)=>{const f=A;return o(),r("div",{ref_key:"controlPanel",ref:s,style:M({transform:`translate(${l(b).x}px, ${l(b).y}px)`}),class:"bg-black bg-opacity-40 backdrop-blur-sm rounded-lg p-3 space-y-3 select-none"},[t("div",{onMousedown:m,onTouchstart:m,class:"drag-handle flex items-center justify-center py-1 cursor-move border-b border-gray-600 mb-2 -mt-1"},[...n[14]||(n[14]=[Ee('<div class="flex space-x-1" data-v-d09cfb02><div class="w-1 h-1 bg-gray-400 rounded-full" data-v-d09cfb02></div><div class="w-1 h-1 bg-gray-400 rounded-full" data-v-d09cfb02></div><div class="w-1 h-1 bg-gray-400 rounded-full" data-v-d09cfb02></div><div class="w-1 h-1 bg-gray-400 rounded-full" data-v-d09cfb02></div><div class="w-1 h-1 bg-gray-400 rounded-full" data-v-d09cfb02></div></div>',1)])],32),t("div",ns,[e.gamePhase==="bidding"&&e.isMyTurn?(o(),r("div",as,[e.biddingInfo?.phase==="calling"?(o(),r(P,{key:0},[t("button",{onClick:n[0]||(n[0]=h=>e.$emit("bid-landlord","call")),class:"btn btn-warning btn-sm text-xs"}," 叫地主 "),t("button",{onClick:n[1]||(n[1]=h=>e.$emit("bid-landlord","pass")),class:"btn btn-secondary btn-sm text-xs"}," 不叫 ")],64)):g("",!0),e.biddingInfo?.phase==="grabbing"?(o(),r(P,{key:1},[t("button",{onClick:n[2]||(n[2]=h=>e.$emit("bid-landlord","grab")),class:"btn btn-danger btn-sm text-xs"}," 抢地主 "),t("button",{onClick:n[3]||(n[3]=h=>e.$emit("bid-landlord","pass")),class:"btn btn-secondary btn-sm text-xs"}," 不抢 ")],64)):g("",!0)])):g("",!0),e.gamePhase==="playing"&&e.isMyTurn&&e.canPlay?(o(),r("button",{key:1,onClick:n[4]||(n[4]=h=>e.$emit("play-cards")),class:"btn btn-success w-full text-sm"},[p(f,{name:"play",class:"w-4 h-4 mr-1"}),n[15]||(n[15]=$(" 出牌 ",-1))])):g("",!0),e.gamePhase==="playing"&&e.isMyTurn&&e.canPass?(o(),r("button",{key:2,onClick:n[5]||(n[5]=h=>e.$emit("pass-turn")),class:"btn btn-secondary w-full text-sm"},[p(f,{name:"x",class:"w-4 h-4 mr-1"}),n[16]||(n[16]=$(" 不要 ",-1))])):g("",!0),e.gamePhase==="multiplier"&&e.isMyTurn?(o(),r("div",os,[t("button",{onClick:n[6]||(n[6]=h=>e.$emit("multiplier-decision","double")),class:"btn btn-warning btn-sm text-xs"},[p(f,{name:"plus",class:"w-3 h-3 mr-1"}),n[17]||(n[17]=$(" 加倍 ",-1))]),t("button",{onClick:n[7]||(n[7]=h=>e.$emit("multiplier-decision","pass")),class:"btn btn-secondary btn-sm text-xs"},[p(f,{name:"x",class:"w-3 h-3 mr-1"}),n[18]||(n[18]=$(" 不加倍 ",-1))])])):g("",!0)]),t("div",rs,[t("button",{onClick:n[8]||(n[8]=h=>e.$emit("get-hint")),class:"btn btn-secondary btn-sm",title:"获取出牌提示"},[p(f,{name:"lightbulb",class:"w-3 h-3"})]),t("button",{onClick:n[9]||(n[9]=h=>e.$emit("toggle-auto-play")),class:w(["btn btn-sm",e.autoPlayEnabled?"btn-danger":"btn-secondary"]),title:e.autoPlayEnabled?"取消托管":"开启托管"},[p(f,{name:e.autoPlayEnabled?"robot":"user",class:"w-3 h-3"},null,8,["name"])],10,ls),t("button",{onClick:n[10]||(n[10]=h=>e.$emit("show-history")),class:"btn btn-secondary btn-sm",title:"查看出牌历史"},[p(f,{name:"history",class:"w-3 h-3"})]),t("button",{onClick:n[11]||(n[11]=h=>e.$emit("show-settings")),class:"btn btn-secondary btn-sm",title:"游戏设置"},[p(f,{name:"settings",class:"w-3 h-3"})]),t("button",{onClick:n[12]||(n[12]=h=>e.$emit("pause-game")),class:"btn btn-warning btn-sm",title:"暂停游戏"},[p(f,{name:"pause",class:"w-3 h-3"})]),t("button",{onClick:n[13]||(n[13]=h=>e.$emit("show-game-info")),class:"btn btn-info btn-sm",title:"游戏信息"},[p(f,{name:"info",class:"w-3 h-3"})])]),e.isMyTurn&&e.timeLeft>0?(o(),r("div",is,[n[19]||(n[19]=t("div",{class:"text-white text-xs mb-1"},"剩余时间",-1)),t("div",ds,[t("div",{class:w(["text-lg font-bold",e.timeLeft<=10?"text-red-400 animate-pulse":"text-white"])},y(e.timeLeft)+"s ",3)]),t("div",cs,[t("div",{class:w(["h-1 rounded-full transition-all duration-1000",e.timeLeft<=10?"bg-red-500":"bg-blue-500"]),style:M({width:`${e.timeLeft/45*100}%`})},null,6)])])):g("",!0),e.autoPlayEnabled?(o(),r("div",us,[t("div",ms,[p(f,{name:"robot",class:"w-3 h-3 mr-1 animate-spin"}),n[20]||(n[20]=$(" AI托管中 ",-1))])])):g("",!0)],4)}}}),ys=L(ps,[["__scopeId","data-v-d09cfb02"]]),gs={class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm"},bs={class:"bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full mx-4 text-center animate-scale-in"},fs={class:"mb-6"},hs={class:"text-gray-600"},vs={class:"mb-6"},xs={class:"space-y-3"},ws={class:"flex items-center space-x-3"},_s={class:"w-8 h-8 bg-gradient-to-br from-blue-400 to-purple-500 rounded-full flex items-center justify-center text-white font-semibold text-sm"},$s={class:"text-left"},ks={class:"font-medium text-gray-900"},Ps={key:0,class:"text-xs text-blue-600 ml-1"},Cs={class:"text-xs text-gray-500"},Is={class:"mb-6 p-4 bg-gray-50 rounded-lg"},Ss={class:"grid grid-cols-2 gap-4 text-sm"},Ts={class:"text-center"},Ls={class:"text-gray-600"},Ns={class:"text-center"},As={class:"text-gray-600"},Ds={class:"space-y-3"},Es={class:"mt-4 pt-4 border-t border-gray-200"},Ms=I({__name:"GameResultModal",props:{result:{},players:{}},emits:["play-again","return-to-lobby"],setup(k,{emit:s}){const b=k,x=D(),a=v(()=>x.playerId),i=e=>e.charAt(0).toUpperCase(),m=e=>{const n=Math.floor(e/1e3),f=Math.floor(n/60),h=n%60;return f>0?`${f}分${h}秒`:`${h}秒`},u=e=>new Date(e).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}),d=async()=>{const e=`我在斗地主网游中${b.result.winnerId===a.value?"获胜了":"战败了"}！最终得分：${b.result.finalScores.find(n=>n.playerId===a.value)?.score||0}分`;if(navigator.share)try{await navigator.share({title:"斗地主游戏结果",text:e,url:window.location.origin})}catch{}else try{await navigator.clipboard.writeText(e),x.showNotification({type:"success",title:"复制成功",message:"游戏结果已复制到剪贴板"})}catch(n){console.error("复制失败:",n)}};return j(()=>{b.result.winnerId===a.value?console.log("播放胜利音效"):console.log("播放失败音效")}),(e,n)=>{const f=A;return o(),T(V,{to:"body"},[t("div",gs,[t("div",bs,[t("div",fs,[t("div",{class:w(["text-6xl mb-4",e.result.winnerId===l(a)?"animate-bounce":""])},y(e.result.winnerId===l(a)?"🎉":"😢"),3),t("h2",{class:w(["text-2xl font-bold mb-2",e.result.winnerId===l(a)?"text-green-600":"text-red-600"])},y(e.result.winnerId===l(a)?"恭喜获胜！":"游戏失败"),3),t("p",hs,y(e.result.isLandlordWin?"地主获胜":"农民获胜"),1)]),t("div",vs,[n[2]||(n[2]=t("h3",{class:"text-lg font-semibold mb-4 text-gray-800"},"最终得分",-1)),t("div",xs,[(o(!0),r(P,null,C(e.result.finalScores,h=>(o(),r("div",{key:h.playerId,class:w(["flex items-center justify-between p-3 rounded-lg",h.playerId===l(a)?"bg-blue-50 border-2 border-blue-200":"bg-gray-50"])},[t("div",ws,[t("div",_s,y(i(h.playerName)),1),t("div",$s,[t("div",ks,[$(y(h.playerName)+" ",1),h.playerId===l(a)?(o(),r("span",Ps," (你) ")):g("",!0)]),t("div",Cs,y(h.isLandlord?"地主":"农民"),1)])]),t("div",{class:w(["font-bold text-lg",h.score>0?"text-green-600":h.score<0?"text-red-600":"text-gray-600"])},y(h.score>0?"+":"")+y(h.score),3)],2))),128))])]),t("div",Is,[t("div",Ss,[t("div",Ts,[n[3]||(n[3]=t("div",{class:"font-semibold text-gray-900"},"游戏时长",-1)),t("div",Ls,y(m(e.result.gameDuration)),1)]),t("div",Ns,[n[4]||(n[4]=t("div",{class:"font-semibold text-gray-900"},"结束时间",-1)),t("div",As,y(u(e.result.gameEndTime)),1)])])]),t("div",Ds,[t("button",{onClick:n[0]||(n[0]=h=>e.$emit("play-again")),class:"btn btn-primary btn-lg w-full"},[p(f,{name:"refresh",class:"w-5 h-5 mr-2"}),n[5]||(n[5]=$(" 再来一局 ",-1))]),t("button",{onClick:n[1]||(n[1]=h=>e.$emit("return-to-lobby")),class:"btn btn-secondary w-full"},[p(f,{name:"home",class:"w-5 h-5 mr-2"}),n[6]||(n[6]=$(" 返回大厅 ",-1))])]),t("div",Es,[t("button",{onClick:d,class:"text-sm text-gray-500 hover:text-gray-700 transition-colors"},[p(f,{name:"share",class:"w-4 h-4 mr-1"}),n[7]||(n[7]=$(" 分享游戏结果 ",-1))])])])])])}}}),js=L(Ms,[["__scopeId","data-v-39b28cb1"]]),Gs={class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm"},Bs={class:"bg-white rounded-2xl shadow-2xl p-8 max-w-sm w-full mx-4 text-center animate-fade-in"},Hs={class:"mb-6"},zs={class:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4"},Rs={class:"space-y-3"},Fs={class:"mt-6 pt-6 border-t border-gray-200 text-sm text-gray-500"},Xs={class:"grid grid-cols-2 gap-4"},Ys={class:"text-center"},Vs={class:"text-center"},Us=I({__name:"PauseMenu",emits:["resume","settings","exit"],setup(k,{emit:s}){const b=s,x=D(),a=v(()=>x.gameState?.turn||1),i=v(()=>{const d=x.gameState?.playHistory[0]?.timestamp||Date.now(),e=Date.now()-d,n=Math.floor(e/6e4),f=Math.floor(e%6e4/1e3);return`${n}:${f.toString().padStart(2,"0")}`}),m=async()=>{await x.showConfirmDialog({title:"确认退出",message:"确定要退出当前游戏吗？游戏进度将会丢失。",confirmText:"退出",cancelText:"取消"})&&b("exit")},u=d=>{d.code==="Escape"&&(d.preventDefault(),b("resume"))};return j(()=>{window.addEventListener("keydown",u)}),re(()=>{window.removeEventListener("keydown",u)}),(d,e)=>{const n=A;return o(),T(V,{to:"body"},[t("div",Gs,[t("div",Bs,[t("div",Hs,[t("div",zs,[p(n,{name:"pause",class:"w-8 h-8 text-gray-600"})]),e[2]||(e[2]=t("h2",{class:"text-2xl font-bold text-gray-800 mb-2"}," 游戏已暂停 ",-1)),e[3]||(e[3]=t("p",{class:"text-gray-600"}," 选择下一步操作 ",-1))]),t("div",Rs,[t("button",{onClick:e[0]||(e[0]=f=>d.$emit("resume")),class:"btn btn-primary btn-lg w-full"},[p(n,{name:"play",class:"w-5 h-5 mr-2"}),e[4]||(e[4]=$(" 继续游戏 ",-1))]),t("button",{onClick:e[1]||(e[1]=f=>d.$emit("settings")),class:"btn btn-secondary w-full"},[p(n,{name:"settings",class:"w-5 h-5 mr-2"}),e[5]||(e[5]=$(" 游戏设置 ",-1))]),t("button",{onClick:m,class:"btn btn-danger w-full"},[p(n,{name:"door-open",class:"w-5 h-5 mr-2"}),e[6]||(e[6]=$(" 退出游戏 ",-1))])]),t("div",Fs,[t("div",Xs,[t("div",Ys,[e[7]||(e[7]=t("div",{class:"font-medium text-gray-700"},"当前回合",-1)),t("div",null,y(l(a)),1)]),t("div",Vs,[e[8]||(e[8]=t("div",{class:"font-medium text-gray-700"},"游戏时长",-1)),t("div",null,y(l(i)),1)])])]),e[9]||(e[9]=t("div",{class:"mt-4 text-xs text-gray-400"}," 按 ESC 键继续游戏 ",-1))])])])}}}),Ks=L(Us,[["__scopeId","data-v-045c6c6a"]]),qs={class:"flex-shrink-0"},Js={class:"flex flex-col"},Os={class:"font-bold text-lg"},Qs={class:"text-sm opacity-90"},Ws={key:0,class:"flex space-x-1 ml-4"},Zs={key:0,class:"text-xs text-gray-300 flex items-center"},en=I({__name:"ActionFeedback",setup(k){const{feedbacks:s}=Me(),b=m=>{switch(m){case"bid":return"border-yellow-400 text-yellow-100";case"play":return"border-green-400 text-green-100";case"pass":return"border-gray-400 text-gray-100";case"landlord":return"border-red-400 text-red-100";case"auto-play":return"border-blue-400 text-blue-100";default:return"border-white text-white"}},x=m=>{switch(m){case"bid":return"megaphone";case"play":return"cards";case"pass":return"x-circle";case"landlord":return"star";case"auto-play":return"robot";default:return"info"}},a=m=>{const u=D();if(m.playerName===u.playerName)return{bottom:"140px",left:"32px",transform:"none"};{const n=u.players.findIndex(f=>f.name===m.playerName);if(n===1)return{top:"80px",left:"32px",transform:"none"};if(n===2)return{top:"80px",right:"32px",transform:"none"}}return{top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},i=m=>{switch(m){case"hearts":case"diamonds":return"text-red-500";case"spades":case"clubs":return"text-black";case"joker":return"text-purple-600";default:return"text-black"}};return(m,u)=>{const d=A;return o(),T(V,{to:"body"},[p(je,{name:"action-feedback",tag:"div",class:"fixed inset-0 pointer-events-none z-[8000]"},{default:Ge(()=>[(o(!0),r(P,null,C(l(s),e=>(o(),r("div",{key:e.id,class:w(["action-feedback-item absolute","bg-black bg-opacity-80 text-white px-4 py-2 rounded-xl shadow-2xl","flex items-center space-x-2 backdrop-blur-sm","border border-white border-opacity-20",b(e.type)]),style:M({...a(e),zIndex:8e3+e.id})},[t("div",qs,[p(d,{name:x(e.type),class:"w-6 h-6"},null,8,["name"])]),t("div",Js,[t("div",Os,y(e.playerName),1),t("div",Qs,y(e.message),1)]),e.cards&&e.cards.length>0?(o(),r("div",Ws,[(o(!0),r(P,null,C(e.cards.slice(0,5),n=>(o(),r("div",{key:n.id,class:w(["w-4 h-6 bg-white rounded text-xs flex items-center justify-center",i(n.suit)])},y(n.rank),3))),128)),e.cards.length>5?(o(),r("div",Zs," +"+y(e.cards.length-5),1)):g("",!0)])):g("",!0)],6))),128))]),_:1})])}}}),tn=L(en,[["__scopeId","data-v-24d68c4e"]]),sn={class:"game-container"},nn={class:"game-table"},an={class:"player-area absolute left-8 top-16"},on={class:"player-area absolute right-8 top-16"},rn={class:"absolute left-1/2 top-1/3 transform -translate-x-1/2 -translate-y-1/2 flex items-center justify-center"},ln={class:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-300 shadow-lg"},dn={class:"fixed bottom-5 right-12 z-50"},cn=I({__name:"game",setup(k){const s=D(),b=N(!1),x=N(!1),a=N(null),i=v(()=>s.gamePhase),m=v(()=>s.currentPlayer),u=v(()=>s.gameState.currentPlayerId),d=v(()=>s.currentPlayer?.name||""),e=v(()=>s.landlord),n=v(()=>s.players),f=v(()=>s.opponents),h=v(()=>s.playerCards),G=v(()=>s.selectedCards),ie=v(()=>s.lastPlayedCards),de=v(()=>s.bottomCards),U=v(()=>s.playHistory),B=v(()=>s.biddingInfo),H=v(()=>s.currentPlayedCards),K=v(()=>s.gameResult),ce=v(()=>s.isPaused),z=v(()=>s.isMyTurn),R=v(()=>s.canPlay),q=v(()=>s.canPass),ue=v(()=>s.autoPlayEnabled),me=v(()=>s.turnTimeLeft),pe=v(()=>s.suggestedCards),ye=v(()=>s.canPlayerDouble(s.playerId)),F=v(()=>s.multiplierInfo);Y([e,()=>s.playerId],([c,_])=>{console.log("=== 地主状态变化 ==="),console.log("地主对象:",c),console.log("地主ID:",c?.id),console.log("当前玩家ID:",_),console.log("是否是地主:",c?.id===_),console.log("===================")},{immediate:!0});const ge=c=>{s.selectCard(c)},J=async()=>{try{await s.playSelectedCards()}catch(c){console.error("出牌失败:",c),s.showNotification({type:"error",title:"出牌失败",message:"无法出牌，请检查选择的牌型"})}},O=async()=>{try{await s.passTurn()}catch(c){console.error("过牌失败:",c)}},Q=()=>{s.getPlayingHint()},W=()=>{s.toggleAutoPlay()},be=async c=>{try{await s.handleBidLandlord(s.playerId,c)}catch(_){console.error("叫地主失败:",_)}},Z=()=>{console.log("暂停游戏按钮被点击"),s.pauseGame(),console.log("游戏已暂停，isPaused:",s.isPaused)},fe=()=>{s.resumeGame()},ee=()=>{b.value=!0},he=()=>{const c=D(),_={waiting:"等待中",bidding:"叫地主",multiplier:"决定倍数",playing:"游戏中",ended:"已结束"}[i.value]||"未知",S=m.value?m.value.name:"无",E=e.value?e.value.name:"未确定";c.showNotification({type:"info",title:"游戏信息",message:`阶段: ${_} | 当前: ${S} | 地主: ${E}`,duration:4e3})},ve=()=>{x.value=!0},xe=c=>{s.updateSettings(c),b.value=!1},we=async()=>{try{if(console.log("🔄 重新开始游戏"),s.players.some(_=>_.isAutoPlay)){console.log("🤖 AI模式 - 重新创建AI对局");const _=s.players.find(E=>E.isAutoPlay);let S="normal";_?.name.includes("新手")||_?.name.includes("学徒")?S="easy":(_?.name.includes("大师")||_?.name.includes("宗师"))&&(S="hard"),console.log("🎯 检测到AI难度:",S),await s.startAIGame(S)}else console.log("👥 多人模式 - 重置游戏状态"),await s.startNewGame();console.log("✅ 游戏重新开始成功")}catch(c){console.error("❌ 开始新游戏失败:",c)}},_e=async()=>{await s.showConfirmDialog({title:"确认退出",message:"确定要退出游戏返回大厅吗？",confirmText:"退出",cancelText:"取消"})&&await te()},te=async()=>{try{await s.exitGame(),await X("/")}catch(c){console.error("退出游戏失败:",c)}},$e=c=>{s.handleMultiplierDecision(s.playerId,c)},se=c=>c?i.value==="bidding"?B.value.currentBidderId===c:i.value==="multiplier"?F.value.currentPlayerId===c:i.value==="playing"?u.value===c:!1:!1,ne=c=>{if(z.value)switch(c.code){case"Space":c.preventDefault(),R.value&&J();break;case"KeyP":c.preventDefault(),q.value&&O();break;case"KeyH":c.preventDefault(),Q();break;case"KeyA":c.preventDefault(),W();break;case"Escape":c.preventDefault(),Z();break}};return j(async()=>{try{if(!s.isGameActive){await X("/");return}await s.initializeGameUI(),s.startGameLoop(),window.addEventListener("keydown",ne),console.log("游戏界面初始化完成")}catch(c){console.error("游戏初始化失败:",c),await X("/")}}),Be(()=>{window.removeEventListener("keydown",ne),s.stopGameLoop()}),Y(()=>s.gamePhase,c=>{c==="ended"&&setTimeout(()=>{s.showGameResult()},1e3)}),j(()=>{document.addEventListener("visibilitychange",()=>{document.hidden?s.isGameActive&&!s.isPaused&&s.pauseGame():s.isPaused&&s.isGameActive&&s.showNotification({type:"info",title:"游戏已暂停",message:"点击恢复继续游戏",actions:[{label:"恢复游戏",action:()=>s.resumeGame()}]})})}),window.addEventListener("beforeunload",c=>{if(s.isGameActive)return c.preventDefault(),c.returnValue="游戏正在进行中，确定要离开吗？",c.returnValue}),He({title:"斗地主网游 - 游戏中",description:"正在进行斗地主游戏",robots:"noindex, nofollow"}),(c,_)=>{const S=lt,E=It,ke=Ht,Pe=ss,Ce=ys,Ie=ae("NetworkIndicator"),Se=js,Te=Ks,Le=ze,Ne=ae("PlayHistoryModal"),Ae=tn;return o(),r("div",sn,[t("div",nn,[t("div",an,[l(f)[0]?(o(),T(S,{key:0,player:l(f)[0],"is-current-turn":se(l(f)[0]?.id),"is-landlord":l(e)?.id===l(f)[0]?.id,"game-phase":l(i),"current-played-cards":l(H),position:"left"},null,8,["player","is-current-turn","is-landlord","game-phase","current-played-cards"])):g("",!0)]),t("div",on,[l(f)[1]?(o(),T(S,{key:0,player:l(f)[1],"is-current-turn":se(l(f)[1]?.id),"is-landlord":l(e)?.id===l(f)[1]?.id,"game-phase":l(i),"current-played-cards":l(H),position:"right"},null,8,["player","is-current-turn","is-landlord","game-phase","current-played-cards"])):g("",!0)]),t("div",rn,[p(E,{"last-played-cards":l(ie),"current-player-name":l(d),"bottom-cards":l(de),"play-history":l(U),"game-phase":l(i)},null,8,["last-played-cards","current-player-name","bottom-cards","play-history","game-phase"])]),p(ke,{phase:l(i),"bidding-info":l(B),"multiplier-info":l(F),class:"absolute top-4 left-1/2 transform -translate-x-1/2"},null,8,["phase","bidding-info","multiplier-info"])]),t("div",ln,[p(Pe,{cards:l(h),"selected-cards":l(G),"can-play":l(R),"is-my-turn":l(z),"suggested-cards":l(pe),"game-phase":l(i),"is-landlord":l(e)?.id===l(s).playerId,"current-played-cards":l(H),"player-name":l(s).playerName,onSelectCard:ge},null,8,["cards","selected-cards","can-play","is-my-turn","suggested-cards","game-phase","is-landlord","current-played-cards","player-name"])]),t("div",dn,[p(Ce,{"game-phase":l(i),"is-my-turn":l(z),"can-play":l(R),"can-pass":l(q),"auto-play-enabled":l(ue),"time-left":l(me),"can-double":l(ye),"bidding-info":l(B),"multiplier-info":l(F),onBidLandlord:be,onPlayCards:J,onPassTurn:O,onGetHint:Q,onToggleAutoPlay:W,onShowHistory:ve,onShowSettings:ee,onPauseGame:Z,onShowGameInfo:he,onMultiplierDecision:$e},null,8,["game-phase","is-my-turn","can-play","can-pass","auto-play-enabled","time-left","can-double","bidding-info","multiplier-info"])]),p(Ie,{latency:c.networkLatency,quality:c.networkQuality,"connection-type":c.connectionType,class:"fixed top-4 left-4"},null,8,["latency","quality","connection-type"]),l(K)?(o(),T(Se,{key:0,result:l(K),players:l(n),onPlayAgain:we,onReturnToLobby:_e},null,8,["result","players"])):g("",!0),l(ce)?(o(),T(Te,{key:1,onResume:fe,onSettings:ee,onExit:te})):g("",!0),l(b)?(o(),T(Le,{key:2,onClose:_[0]||(_[0]=De=>b.value=!1),onSave:xe})):g("",!0),l(x)?(o(),T(Ne,{key:3,history:l(U),onClose:_[1]||(_[1]=De=>x.value=!1)},null,8,["history"])):g("",!0),p(Ae,{ref_key:"actionFeedbackRef",ref:a},null,512)])}}}),pn=L(cn,[["__scopeId","data-v-9a0a40bf"]]);export{pn as default};
