import{d as S,r as l,o as N,X as P,y as i,A as s,E as r,B as e,H as o,G as k,Y as T,Z as B,$ as A,z as c,_ as $}from"#entry";import{parseRoomFromUrl as D,generateRoomLink as E}from"./BoMY4_lC.js";const V={class:"min-h-screen bg-gray-50 p-8"},z={class:"max-w-4xl mx-auto"},H={class:"space-y-6"},Z={class:"card"},q={class:"card-body"},j={class:"space-y-2 font-mono text-sm"},F={class:"card"},G={class:"card-body"},J={key:0,class:"space-y-2"},O={key:1,class:"text-red-500"},X={class:"card"},Y={class:"card-body"},K={class:"space-y-2"},Q={class:"card"},W={class:"card-body"},ss={key:0,class:"space-y-2"},ts={class:"bg-gray-100 p-2 rounded font-mono text-sm break-all"},os={class:"card"},ns={class:"card-body"},es={class:"space-y-4"},ls={key:0,class:"mt-4"},rs={class:"bg-gray-100 p-3 rounded text-sm"},as=S({__name:"debug",setup(ds){const y=l(""),x=l(""),g=l(""),f=l(""),a=l(null),h=l(null),v=l(null),u=l(""),m=l(""),d=l(null);N(async()=>{y.value=window.location.href,x.value=window.location.hash,g.value=window.location.search,f.value=window.location.pathname;try{a.value=D()}catch(t){console.error("解析失败:",t)}const n=window.location.hash;h.value=n.match(/\/room\/([A-Z0-9]{6})/),v.value=n.match(/\?(.+)$/)});const L=async()=>{try{const n={roomCode:"TEST01",hostPeerId:"test-host-123",hostName:"测试房主",timestamp:Date.now()};u.value=E(n)}catch(n){console.error("生成测试链接失败:",n)}},C=async()=>{try{await navigator.clipboard.writeText(u.value),alert("链接已复制到剪贴板")}catch(n){console.error("复制失败:",n),alert("复制失败")}},I=()=>{try{const t=new URL(m.value).hash,p=t.match(/\/room\/([A-Z0-9]{6})/);if(!p){d.value={error:"未匹配到房间码路径"};return}const M=p[1],w=t.match(/\?(.+)$/);if(!w){d.value={error:"未找到查询参数"};return}const b=new URLSearchParams(w[1]),_=b.get("host"),R=b.get("name"),U=b.get("t");d.value={roomCode:M,hostPeerId:_,hostName:R,timestamp:U,success:!!(_&&R&&U)}}catch(n){d.value={error:n instanceof Error?n.message:String(n)}}};return P({title:"URL解析诊断工具",description:"调试房间分享链接的URL解析问题",robots:"noindex, nofollow"}),(n,t)=>(c(),i("div",V,[s("div",z,[t[19]||(t[19]=s("h1",{class:"text-3xl font-bold mb-8"},"🔍 URL解析诊断工具",-1)),s("div",H,[s("div",Z,[t[5]||(t[5]=s("div",{class:"card-header"},[s("h2",{class:"text-xl font-semibold"},"当前URL信息")],-1)),s("div",q,[s("div",j,[s("p",null,[t[1]||(t[1]=s("strong",null,"完整URL:",-1)),r(" "+e(o(y)),1)]),s("p",null,[t[2]||(t[2]=s("strong",null,"Hash:",-1)),r(" "+e(o(x)),1)]),s("p",null,[t[3]||(t[3]=s("strong",null,"Search:",-1)),r(" "+e(o(g)),1)]),s("p",null,[t[4]||(t[4]=s("strong",null,"Pathname:",-1)),r(" "+e(o(f)),1)])])])]),s("div",F,[t[10]||(t[10]=s("div",{class:"card-header"},[s("h2",{class:"text-xl font-semibold"},"URL解析结果")],-1)),s("div",G,[o(a)?(c(),i("div",J,[s("p",null,[t[6]||(t[6]=s("strong",null,"房间码:",-1)),r(" "+e(o(a).roomCode),1)]),s("p",null,[t[7]||(t[7]=s("strong",null,"房主ID:",-1)),r(" "+e(o(a).hostInfo.hostPeerId),1)]),s("p",null,[t[8]||(t[8]=s("strong",null,"房主名称:",-1)),r(" "+e(o(a).hostInfo.hostName),1)]),s("p",null,[t[9]||(t[9]=s("strong",null,"时间戳:",-1)),r(" "+e(o(a).hostInfo.timestamp),1)])])):(c(),i("div",O," ❌ 无法解析URL中的房间信息 "))])]),s("div",X,[t[13]||(t[13]=s("div",{class:"card-header"},[s("h2",{class:"text-xl font-semibold"},"正则匹配测试")],-1)),s("div",Y,[s("div",K,[s("p",null,[t[11]||(t[11]=s("strong",null,"路径匹配:",-1)),r(" "+e(o(h)?`✅ ${o(h)[1]}`:"❌ 未匹配"),1)]),s("p",null,[t[12]||(t[12]=s("strong",null,"查询匹配:",-1)),r(" "+e(o(v)?`✅ ${o(v)[1]}`:"❌ 未匹配"),1)])])])]),s("div",Q,[t[15]||(t[15]=s("div",{class:"card-header"},[s("h2",{class:"text-xl font-semibold"},"测试链接生成")],-1)),s("div",W,[s("button",{onClick:L,class:"btn btn-primary mb-4"}," 生成测试链接 "),o(u)?(c(),i("div",ss,[t[14]||(t[14]=s("p",null,[s("strong",null,"生成的链接:")],-1)),s("div",ts,e(o(u)),1),s("button",{onClick:C,class:"btn btn-secondary btn-sm"}," 复制链接 ")])):k("",!0)])]),s("div",os,[t[18]||(t[18]=s("div",{class:"card-header"},[s("h2",{class:"text-xl font-semibold"},"手动测试")],-1)),s("div",ns,[s("div",es,[s("div",null,[t[16]||(t[16]=s("label",{class:"block text-sm font-medium mb-2"},"测试URL:",-1)),T(s("input",{"onUpdate:modelValue":t[0]||(t[0]=p=>A(m)?m.value=p:null),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"https://zyhwy5.github.io/doudizhu/#/room/ABC123?join=ABC123&host=xxx&name=xxx&t=xxx"},null,512),[[B,o(m)]])]),s("button",{onClick:I,class:"btn btn-primary"}," 解析测试URL "),o(d)?(c(),i("div",ls,[t[17]||(t[17]=s("h3",{class:"font-semibold mb-2"},"解析结果:",-1)),s("pre",rs,e(JSON.stringify(o(d),null,2)),1)])):k("",!0)])])])])])]))}}),us=$(as,[["__scopeId","data-v-eab79556"]]);export{us as default};
