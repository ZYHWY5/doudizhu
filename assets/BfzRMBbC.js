import{d as E,r,o as M,Y as U,X as S,y as c,A as s,E as l,B as e,H as o,G as k,Z as A,$ as N,a0 as B,z as u,_ as D}from"#entry";const V={class:"min-h-screen bg-gray-50 p-8"},$={class:"max-w-4xl mx-auto"},z={class:"space-y-6"},H={class:"card"},O={class:"card-body"},Z={class:"space-y-2 font-mono text-sm"},q={class:"card"},F={class:"card-body"},j={key:0,class:"space-y-2"},G={key:1,class:"text-red-500"},J={class:"card"},X={class:"card-body"},Y={class:"space-y-2"},K={class:"card"},Q={class:"card-body"},W={key:0,class:"space-y-2"},ss={class:"bg-gray-100 p-2 rounded font-mono text-sm break-all"},ts={class:"card"},os={class:"card-body"},ns={class:"space-y-4"},es={key:0,class:"mt-4"},rs={class:"bg-gray-100 p-3 rounded text-sm"},ls=E({__name:"debug",setup(as){const b=r(""),x=r(""),g=r(""),f=r(""),d=r(null),v=r(null),h=r(null),m=r(""),p=r(""),i=r(null);M(async()=>{b.value=window.location.href,x.value=window.location.hash,g.value=window.location.search,f.value=window.location.pathname;try{const{parseRoomFromUrl:t}=await U(async()=>{const{parseRoomFromUrl:a}=await import("./BoMY4_lC.js");return{parseRoomFromUrl:a}},[],import.meta.url);d.value=t()}catch(t){console.error("解析失败:",t)}const n=window.location.hash;v.value=n.match(/\/room\/([A-Z0-9]{6})/),h.value=n.match(/\?(.+)$/)});const I=async()=>{try{const{generateRoomLink:n}=await U(async()=>{const{generateRoomLink:a}=await import("./BoMY4_lC.js");return{generateRoomLink:a}},[],import.meta.url),t={roomCode:"TEST01",hostPeerId:"test-host-123",hostName:"测试房主",timestamp:Date.now()};m.value=n(t)}catch(n){console.error("生成测试链接失败:",n)}},C=async()=>{try{await navigator.clipboard.writeText(m.value),alert("链接已复制到剪贴板")}catch(n){console.error("复制失败:",n),alert("复制失败")}},P=()=>{try{const t=new URL(p.value).hash,a=t.match(/\/room\/([A-Z0-9]{6})/);if(!a){i.value={error:"未匹配到房间码路径"};return}const T=a[1],_=t.match(/\?(.+)$/);if(!_){i.value={error:"未找到查询参数"};return}const y=new URLSearchParams(_[1]),w=y.get("host"),R=y.get("name"),L=y.get("t");i.value={roomCode:T,hostPeerId:w,hostName:R,timestamp:L,success:!!(w&&R&&L)}}catch(n){i.value={error:n instanceof Error?n.message:String(n)}}};return S({title:"URL解析诊断工具",description:"调试房间分享链接的URL解析问题",robots:"noindex, nofollow"}),(n,t)=>(u(),c("div",V,[s("div",$,[t[19]||(t[19]=s("h1",{class:"text-3xl font-bold mb-8"},"🔍 URL解析诊断工具",-1)),s("div",z,[s("div",H,[t[5]||(t[5]=s("div",{class:"card-header"},[s("h2",{class:"text-xl font-semibold"},"当前URL信息")],-1)),s("div",O,[s("div",Z,[s("p",null,[t[1]||(t[1]=s("strong",null,"完整URL:",-1)),l(" "+e(o(b)),1)]),s("p",null,[t[2]||(t[2]=s("strong",null,"Hash:",-1)),l(" "+e(o(x)),1)]),s("p",null,[t[3]||(t[3]=s("strong",null,"Search:",-1)),l(" "+e(o(g)),1)]),s("p",null,[t[4]||(t[4]=s("strong",null,"Pathname:",-1)),l(" "+e(o(f)),1)])])])]),s("div",q,[t[10]||(t[10]=s("div",{class:"card-header"},[s("h2",{class:"text-xl font-semibold"},"URL解析结果")],-1)),s("div",F,[o(d)?(u(),c("div",j,[s("p",null,[t[6]||(t[6]=s("strong",null,"房间码:",-1)),l(" "+e(o(d).roomCode),1)]),s("p",null,[t[7]||(t[7]=s("strong",null,"房主ID:",-1)),l(" "+e(o(d).hostInfo.hostPeerId),1)]),s("p",null,[t[8]||(t[8]=s("strong",null,"房主名称:",-1)),l(" "+e(o(d).hostInfo.hostName),1)]),s("p",null,[t[9]||(t[9]=s("strong",null,"时间戳:",-1)),l(" "+e(o(d).hostInfo.timestamp),1)])])):(u(),c("div",G," ❌ 无法解析URL中的房间信息 "))])]),s("div",J,[t[13]||(t[13]=s("div",{class:"card-header"},[s("h2",{class:"text-xl font-semibold"},"正则匹配测试")],-1)),s("div",X,[s("div",Y,[s("p",null,[t[11]||(t[11]=s("strong",null,"路径匹配:",-1)),l(" "+e(o(v)?`✅ ${o(v)[1]}`:"❌ 未匹配"),1)]),s("p",null,[t[12]||(t[12]=s("strong",null,"查询匹配:",-1)),l(" "+e(o(h)?`✅ ${o(h)[1]}`:"❌ 未匹配"),1)])])])]),s("div",K,[t[15]||(t[15]=s("div",{class:"card-header"},[s("h2",{class:"text-xl font-semibold"},"测试链接生成")],-1)),s("div",Q,[s("button",{onClick:I,class:"btn btn-primary mb-4"}," 生成测试链接 "),o(m)?(u(),c("div",W,[t[14]||(t[14]=s("p",null,[s("strong",null,"生成的链接:")],-1)),s("div",ss,e(o(m)),1),s("button",{onClick:C,class:"btn btn-secondary btn-sm"}," 复制链接 ")])):k("",!0)])]),s("div",ts,[t[18]||(t[18]=s("div",{class:"card-header"},[s("h2",{class:"text-xl font-semibold"},"手动测试")],-1)),s("div",os,[s("div",ns,[s("div",null,[t[16]||(t[16]=s("label",{class:"block text-sm font-medium mb-2"},"测试URL:",-1)),A(s("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>B(p)?p.value=a:null),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"https://zyhwy5.github.io/doudizhu/#/room/ABC123?join=ABC123&host=xxx&name=xxx&t=xxx"},null,512),[[N,o(p)]])]),s("button",{onClick:P,class:"btn btn-primary"}," 解析测试URL "),o(i)?(u(),c("div",es,[t[17]||(t[17]=s("h3",{class:"font-semibold mb-2"},"解析结果:",-1)),s("pre",rs,e(JSON.stringify(o(i),null,2)),1)])):k("",!0)])])])])])]))}}),is=D(ls,[["__scopeId","data-v-27a83197"]]);export{is as default};
